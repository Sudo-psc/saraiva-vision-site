{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "External WordPress Integration API Schema",
  "description": "JSON Schema for external WordPress integration API contracts",
  "definitions": {
    "ExternalWordPressSource": {
      "type": "object",
      "required": ["name", "base_url"],
      "properties": {
        "id": {
          "type": "integer",
          "description": "Unique identifier for the source"
        },
        "name": {
          "type": "string",
          "minLength": 1,
          "maxLength": 255,
          "description": "Human-readable name for the WordPress source"
        },
        "base_url": {
          "type": "string",
          "format": "uri",
          "pattern": "^https?://",
          "description": "Base URL of the external WordPress site"
        },
        "api_key": {
          "type": ["string", "null"],
          "description": "Application password or API key for authentication"
        },
        "status": {
          "type": "string",
          "enum": ["active", "inactive", "error"],
          "default": "active"
        },
        "last_sync": {
          "type": ["string", "null"],
          "format": "date-time"
        },
        "sync_frequency": {
          "type": "string",
          "pattern": "^\\d+\\s+(seconds?|minutes?|hours?|days?)$",
          "default": "5 minutes"
        },
        "max_posts_per_sync": {
          "type": "integer",
          "minimum": 1,
          "maximum": 1000,
          "default": 100
        },
        "cache_ttl": {
          "type": "integer",
          "minimum": 60,
          "maximum": 86400,
          "default": 300
        },
        "enable_webhooks": {
          "type": "boolean",
          "default": false
        },
        "webhook_secret": {
          "type": ["string", "null"],
          "minLength": 16,
          "maxLength": 255
        },
        "enable_ssl_verification": {
          "type": "boolean",
          "default": true
        },
        "enable_compliance_filter": {
          "type": "boolean",
          "default": true
        },
        "rate_limit_requests": {
          "type": "integer",
          "minimum": 10,
          "maximum": 10000,
          "default": 1000
        },
        "rate_limit_window": {
          "type": "integer",
          "minimum": 60,
          "maximum": 86400,
          "default": 3600
        },
        "wordpress_version": {
          "type": ["string", "null"],
          "pattern": "^\\d+\\.\\d+(\\.\\d+)?$"
        },
        "rest_api_version": {
          "type": "string",
          "enum": ["v1", "v2"],
          "default": "v2"
        },
        "supported_post_types": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "default": ["post", "page"]
        },
        "supported_taxonomies": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "default": ["category", "tag"]
        },
        "health_check_url": {
          "type": ["string", "null"],
          "format": "uri"
        },
        "health_check_interval": {
          "type": "integer",
          "minimum": 60,
          "maximum": 3600,
          "default": 300
        },
        "last_health_check": {
          "type": ["string", "null"],
          "format": "date-time"
        },
        "health_status": {
          "type": ["string", "null"],
          "enum": ["healthy", "degraded", "unhealthy"]
        },
        "created_at": {
          "type": "string",
          "format": "date-time"
        },
        "updated_at": {
          "type": "string",
          "format": "date-time"
        }
      }
    },
    "WordPressPost": {
      "type": "object",
      "required": ["id", "title", "content", "excerpt", "status", "date"],
      "properties": {
        "id": {
          "type": "integer",
          "minimum": 1
        },
        "title": {
          "type": "object",
          "required": ["rendered"],
          "properties": {
            "rendered": {
              "type": "string",
              "minLength": 1
            }
          }
        },
        "content": {
          "type": "object",
          "required": ["rendered"],
          "properties": {
            "rendered": {
              "type": "string"
            },
            "protected": {
              "type": "boolean"
            }
          }
        },
        "excerpt": {
          "type": "object",
          "required": ["rendered"],
          "properties": {
            "rendered": {
              "type": "string"
            },
            "protected": {
              "type": "boolean"
            }
          }
        },
        "status": {
          "type": "string",
          "enum": ["publish", "draft", "pending", "private"]
        },
        "date": {
          "type": "string",
          "format": "date-time"
        },
        "modified": {
          "type": "string",
          "format": "date-time"
        },
        "slug": {
          "type": "string",
          "minLength": 1
        },
        "author": {
          "type": "integer",
          "minimum": 1
        },
        "featured_media": {
          "type": "integer",
          "minimum": 0
        },
        "categories": {
          "type": "array",
          "items": {
            "type": "integer",
            "minimum": 1
          }
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "integer",
            "minimum": 1
          }
        },
        "_links": {
          "type": "object",
          "properties": {
            "self": {
              "type": "object",
              "properties": {
                "href": {
                  "type": "string",
                  "format": "uri"
                }
              }
            }
          }
        }
      }
    },
    "WordPressMedia": {
      "type": "object",
      "required": ["id", "title", "media_type", "source_url"],
      "properties": {
        "id": {
          "type": "integer",
          "minimum": 1
        },
        "title": {
          "type": "object",
          "required": ["rendered"],
          "properties": {
            "rendered": {
              "type": "string"
            }
          }
        },
        "media_type": {
          "type": "string",
          "enum": ["image", "video", "audio", "file"]
        },
        "mime_type": {
          "type": "string",
          "pattern": "^[a-z]+/[a-z0-9.+-]+$"
        },
        "source_url": {
          "type": "string",
          "format": "uri"
        },
        "alt_text": {
          "type": "string"
        },
        "media_details": {
          "type": "object",
          "properties": {
            "width": {
              "type": "integer",
              "minimum": 1
            },
            "height": {
              "type": "integer",
              "minimum": 1
            },
            "file": {
              "type": "string"
            },
            "sizes": {
              "type": "object"
            }
          }
        }
      }
    },
    "WordPressCategory": {
      "type": "object",
      "required": ["id", "name", "slug"],
      "properties": {
        "id": {
          "type": "integer",
          "minimum": 1
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "slug": {
          "type": "string",
          "pattern": "^[a-z0-9-]+$"
        },
        "description": {
          "type": "string"
        },
        "count": {
          "type": "integer",
          "minimum": 0
        },
        "parent": {
          "type": "integer",
          "minimum": 0
        }
      }
    },
    "WordPressTag": {
      "type": "object",
      "required": ["id", "name", "slug"],
      "properties": {
        "id": {
          "type": "integer",
          "minimum": 1
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "slug": {
          "type": "string",
          "pattern": "^[a-z0-9-]+$"
        },
        "description": {
          "type": "string"
        },
        "count": {
          "type": "integer",
          "minimum": 0
        }
      }
    },
    "ExternalContentItem": {
      "type": "object",
      "required": ["id", "source_id", "content_type", "external_id", "content", "cached_at", "expires_at"],
      "properties": {
        "id": {
          "type": "integer",
          "minimum": 1
        },
        "source_id": {
          "type": "integer",
          "minimum": 1
        },
        "content_type": {
          "type": "string",
          "enum": ["post", "page", "media", "category", "tag"]
        },
        "external_id": {
          "type": "integer",
          "minimum": 1
        },
        "content": {
          "oneOf": [
            {"$ref": "#/definitions/WordPressPost"},
            {"$ref": "#/definitions/WordPressMedia"},
            {"$ref": "#/definitions/WordPressCategory"},
            {"$ref": "#/definitions/WordPressTag"}
          ]
        },
        "cached_at": {
          "type": "string",
          "format": "date-time"
        },
        "expires_at": {
          "type": "string",
          "format": "date-time"
        },
        "last_modified": {
          "type": ["string", "null"],
          "format": "date-time"
        },
        "etag": {
          "type": ["string", "null"]
        },
        "title": {
          "type": "string"
        },
        "slug": {
          "type": "string"
        },
        "author_id": {
          "type": ["integer", "null"],
          "minimum": 1
        },
        "published_at": {
          "type": ["string", "null"],
          "format": "date-time"
        },
        "status": {
          "type": "string",
          "enum": ["publish", "draft", "pending", "private"],
          "default": "publish"
        },
        "compliance_score": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "default": 0
        },
        "compliance_filtered": {
          "type": "boolean",
          "default": false
        },
        "compliance_issues": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "type": {
                "type": "string",
                "enum": ["pii", "medical_claim", "disclaimer_missing", "inappropriate_content"]
              },
              "severity": {
                "type": "string",
                "enum": ["low", "medium", "high", "critical"]
              },
              "description": {
                "type": "string"
              },
              "location": {
                "type": "string"
              }
            }
          }
        },
        "cache_hits": {
          "type": "integer",
          "minimum": 0,
          "default": 0
        },
        "last_accessed": {
          "type": ["string", "null"],
          "format": "date-time"
        },
        "response_time": {
          "type": ["integer", "null"],
          "minimum": 0
        }
      }
    },
    "SyncLog": {
      "type": "object",
      "required": ["id", "source_id", "action", "status", "started_at"],
      "properties": {
        "id": {
          "type": "integer",
          "minimum": 1
        },
        "source_id": {
          "type": "integer",
          "minimum": 1
        },
        "action": {
          "type": "string",
          "enum": ["sync", "cache_invalidate", "error", "health_check"]
        },
        "status": {
          "type": "string",
          "enum": ["success", "failed", "partial"]
        },
        "details": {
          "type": "object"
        },
        "started_at": {
          "type": "string",
          "format": "date-time"
        },
        "completed_at": {
          "type": ["string", "null"],
          "format": "date-time"
        },
        "duration": {
          "type": ["integer", "null"],
          "minimum": 0
        },
        "items_processed": {
          "type": "integer",
          "minimum": 0,
          "default": 0
        },
        "items_failed": {
          "type": "integer",
          "minimum": 0,
          "default": 0
        },
        "error_code": {
          "type": ["string", "null"]
        },
        "error_message": {
          "type": ["string", "null"]
        },
        "stack_trace": {
          "type": ["string", "null"]
        },
        "request_url": {
          "type": ["string", "null"],
          "format": "uri"
        },
        "request_method": {
          "type": ["string", "null"],
          "enum": ["GET", "POST", "PUT", "DELETE", "HEAD"]
        },
        "response_status": {
          "type": ["integer", "null"],
          "minimum": 100,
          "maximum": 599
        },
        "response_size": {
          "type": ["integer", "null"],
          "minimum": 0
        },
        "server_info": {
          "type": ["object", "null"]
        },
        "client_info": {
          "type": ["object", "null"]
        }
      }
    },
    "ApiError": {
      "type": "object",
      "required": ["error"],
      "properties": {
        "error": {
          "type": "object",
          "required": ["code", "message"],
          "properties": {
            "code": {
              "type": "string"
            },
            "message": {
              "type": "string"
            },
            "details": {
              "type": "object"
            },
            "timestamp": {
              "type": "string",
              "format": "date-time"
            },
            "request_id": {
              "type": "string"
            }
          }
        }
      }
    },
    "Pagination": {
      "type": "object",
      "required": ["page", "per_page", "total", "total_pages"],
      "properties": {
        "page": {
          "type": "integer",
          "minimum": 1,
          "default": 1
        },
        "per_page": {
          "type": "integer",
          "minimum": 1,
          "maximum": 100,
          "default": 10
        },
        "total": {
          "type": "integer",
          "minimum": 0
        },
        "total_pages": {
          "type": "integer",
          "minimum": 0
        },
        "has_next": {
          "type": "boolean"
        },
        "has_prev": {
          "type": "boolean"
        }
      }
    },
    "ContentFilter": {
      "type": "object",
      "properties": {
        "content_type": {
          "type": "string",
          "enum": ["post", "page", "media", "category", "tag"]
        },
        "status": {
          "type": "string",
          "enum": ["publish", "draft", "pending", "private"]
        },
        "author_id": {
          "type": "integer",
          "minimum": 1
        },
        "categories": {
          "type": "array",
          "items": {
            "type": "integer",
            "minimum": 1
          }
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "integer",
            "minimum": 1
          }
        },
        "search": {
          "type": "string",
          "minLength": 1
        },
        "date_from": {
          "type": "string",
          "format": "date-time"
        },
        "date_to": {
          "type": "string",
          "format": "date-time"
        },
        "compliance_score_min": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100
        },
        "compliance_filtered": {
          "type": "boolean"
        }
      }
    }
  }
}