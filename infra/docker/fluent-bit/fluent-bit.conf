[SERVICE]
    Flush         1
    Log_Level     info
    Daemon        off
    Parsers_File  parsers.conf
    HTTP_Server   On
    HTTP_Listen   0.0.0.0
    HTTP_Port     2020

# Nginx Access Logs
[INPUT]
    Name              tail
    Path              /var/log/nginx/access.log
    Tag               nginx.access
    Parser            nginx_access
    Refresh_Interval  5
    Mem_Buf_Limit     5MB

# Nginx Error Logs
[INPUT]
    Name              tail
    Path              /var/log/nginx/error.log
    Tag               nginx.error
    Parser            nginx_error
    Refresh_Interval  5
    Mem_Buf_Limit     5MB

# API JSON Logs
[INPUT]
    Name              tail
    Path              /var/log/api/*.log
    Tag               api.logs
    Parser            json
    Refresh_Interval  5
    Mem_Buf_Limit     5MB

# Docker Container Logs
[INPUT]
    Name              forward
    Listen            0.0.0.0
    Port              24224
    Buffer_Chunk_Size 1M
    Buffer_Max_Size   6M

# Add timestamp and service tags
[FILTER]
    Name modify
    Match *
    Add service saraiva-vision
    Add environment ${ENVIRONMENT}
    Add facility medical-clinic

# Output to console (for docker logs)
[OUTPUT]
    Name  stdout
    Match *
    Format json_lines

# Output to file (structured logs)
[OUTPUT]
    Name  file
    Match *
    Path  /var/log/host/
    File  saraiva-vision.log
    Format json_lines