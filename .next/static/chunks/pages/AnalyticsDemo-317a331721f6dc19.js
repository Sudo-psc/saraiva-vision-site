(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8317],{6426:()=>{},8322:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/AnalyticsDemo",function(){return a(91256)}])},12292:()=>{},73205:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>r});var n=a(36854);let i={api_host:"https://app.posthog.com",loaded:e=>{},capture_pageview:!1,disable_session_recording:!0,respect_dnt:!0,opt_out_capturing_by_default:!1,cross_subdomain_cookie:!1,secure_cookie:!0,persistence:"localStorage+cookie",cookie_expiration:365,upgrade:!0,disable_persistence:!1,property_blacklist:["$initial_referrer","$initial_referring_domain"]},s=!1,r={initialize:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return void console.warn("PostHog API key not provided or running on server");try{n.Ay.init(e,i),t||n.Ay.opt_out_capturing(),s=!0,console.log("PostHog analytics initialized")}catch(e){console.error("Failed to initialize PostHog:",e)}},enable:()=>{if(!s)return void console.warn("Analytics not initialized");n.Ay.opt_in_capturing(),console.log("Analytics tracking enabled")},disable:()=>{s&&(n.Ay.opt_out_capturing(),console.log("Analytics tracking disabled"))},trackFunnelEvent:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!s||!n.Ay.has_opted_in_capturing())return;let a={page_visit:"Funnel: Page Visit",contact_form_view:"Funnel: Contact Form Viewed",contact_form_submit:"Funnel: Contact Form Submitted",appointment_form_view:"Funnel: Appointment Form Viewed",appointment_form_submit:"Funnel: Appointment Submitted",appointment_confirmed:"Funnel: Appointment Confirmed"}[e];if(!a)return void console.warn("Unknown funnel event: ".concat(e));try{n.Ay.capture(a,{...t,timestamp:new Date().toISOString(),page_url:window.location.href,page_title:document.title})}catch(e){console.error("Failed to track funnel event:",e)}},trackUTMParameters:()=>{if(!s||!n.Ay.has_opted_in_capturing())return;let e=new URLSearchParams(window.location.search),t={};if(["utm_source","utm_medium","utm_campaign","utm_term","utm_content"].forEach(a=>{let n=e.get(a);n&&(t[a]=n)}),Object.keys(t).length>0)try{n.Ay.capture("UTM Parameters Detected",{...t,referrer:document.referrer,landing_page:window.location.pathname}),n.Ay.people.set({$utm_source:t.utm_source,$utm_medium:t.utm_medium,$utm_campaign:t.utm_campaign})}catch(e){console.error("Failed to track UTM parameters:",e)}},trackWebVitals:e=>{if(s&&n.Ay.has_opted_in_capturing())try{n.Ay.capture("Web Vital",{metric_name:e.name,metric_value:e.value,metric_rating:e.rating,page_url:window.location.href})}catch(e){console.error("Failed to track web vital:",e)}},trackPageView:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(s&&n.Ay.has_opted_in_capturing())try{let t=e||window.location.pathname;n.Ay.capture("$pageview",{$current_url:window.location.href,$pathname:t,$title:document.title})}catch(e){console.error("Failed to track page view:",e)}},trackUserInteraction:function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(s&&n.Ay.has_opted_in_capturing())try{n.Ay.capture("User Interaction",{action:e,element:t,...a,page_url:window.location.href})}catch(e){console.error("Failed to track user interaction:",e)}},trackAppointmentMetrics:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!s||!n.Ay.has_opted_in_capturing())return;let a={started:"Appointment: Booking Started",completed:"Appointment: Booking Completed",confirmed:"Appointment: Confirmed",cancelled:"Appointment: Cancelled",no_show:"Appointment: No Show"}[e];if(!a)return void console.warn("Unknown appointment status: ".concat(e));try{n.Ay.capture(a,{...t,timestamp:new Date().toISOString()})}catch(e){console.error("Failed to track appointment metric:",e)}},getInstance:()=>s?n.Ay:null,isEnabled:()=>s&&n.Ay.has_opted_in_capturing()}},91256:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var n=a(37876),i=a(14232),s=a(73205);let r=e=>{let{data:t}=e,a=[{name:"Visitas",value:t.pageViews,percentage:100},{name:"Visualiza\xe7\xf5es do Formul\xe1rio de Contato",value:t.contactFormViews,percentage:(t.contactFormViews/t.pageViews*100).toFixed(1)},{name:"Envios do Formul\xe1rio de Contato",value:t.contactFormSubmits,percentage:(t.contactFormSubmits/t.pageViews*100).toFixed(1)},{name:"Visualiza\xe7\xf5es do Agendamento",value:t.appointmentFormViews,percentage:(t.appointmentFormViews/t.pageViews*100).toFixed(1)},{name:"Agendamentos Enviados",value:t.appointmentFormSubmits,percentage:(t.appointmentFormSubmits/t.pageViews*100).toFixed(1)},{name:"Agendamentos Confirmados",value:t.appointmentConfirmations,percentage:(t.appointmentConfirmations/t.pageViews*100).toFixed(1)}];return(0,n.jsxs)("div",{className:"funnel-visualization",children:[(0,n.jsxs)("div",{className:"conversion-rate",children:[(0,n.jsxs)("span",{className:"rate-value",children:[t.conversionRate,"%"]}),(0,n.jsx)("span",{className:"rate-label",children:"Taxa de Convers\xe3o"})]}),(0,n.jsx)("div",{className:"funnel-steps",children:a.map((e,t)=>(0,n.jsx)("div",{className:"funnel-step",children:(0,n.jsx)("div",{className:"step-bar",style:{width:"".concat(e.percentage,"%")},children:(0,n.jsxs)("div",{className:"step-content",children:[(0,n.jsx)("span",{className:"step-name",children:e.name}),(0,n.jsxs)("span",{className:"step-value",children:[e.value," (",e.percentage,"%)"]})]})})},t))})]})},c=e=>{let{data:t}=e;return Object.values(t).reduce((e,t)=>e+t,0),(0,n.jsx)("div",{className:"traffic-sources",children:(0,n.jsx)("div",{className:"sources-list",children:Object.entries(t).map(e=>{let[t,a]=e;return(0,n.jsxs)("div",{className:"source-item",children:[(0,n.jsxs)("div",{className:"source-info",children:[(0,n.jsx)("span",{className:"source-name",children:d(t)}),(0,n.jsxs)("span",{className:"source-percentage",children:[a,"%"]})]}),(0,n.jsx)("div",{className:"source-bar",children:(0,n.jsx)("div",{className:"source-fill source-".concat(t),style:{width:"".concat(a,"%")}})})]},t)})})})},o=e=>{let{data:t}=e,a=(e,t)=>{let a={lcp:{good:2.5,poor:4},fid:{good:100,poor:300},cls:{good:.1,poor:.25},ttfb:{good:600,poor:1500}}[e];return t<=a.good?"good":t<=a.poor?"needs-improvement":"poor"};return(0,n.jsx)("div",{className:"web-vitals",children:(0,n.jsxs)("div",{className:"vitals-grid",children:[(0,n.jsxs)("div",{className:"vital-item ".concat(a("lcp",t.lcp)),children:[(0,n.jsx)("span",{className:"vital-label",children:"LCP"}),(0,n.jsxs)("span",{className:"vital-value",children:[t.lcp,"s"]})]}),(0,n.jsxs)("div",{className:"vital-item ".concat(a("fid",t.fid)),children:[(0,n.jsx)("span",{className:"vital-label",children:"FID"}),(0,n.jsxs)("span",{className:"vital-value",children:[t.fid,"ms"]})]}),(0,n.jsxs)("div",{className:"vital-item ".concat(a("cls",t.cls)),children:[(0,n.jsx)("span",{className:"vital-label",children:"CLS"}),(0,n.jsx)("span",{className:"vital-value",children:t.cls})]}),(0,n.jsxs)("div",{className:"vital-item ".concat(a("ttfb",t.ttfb)),children:[(0,n.jsx)("span",{className:"vital-label",children:"TTFB"}),(0,n.jsxs)("span",{className:"vital-value",children:[t.ttfb,"ms"]})]})]})})},l=e=>{let{data:t}=e;return(0,n.jsx)("div",{className:"appointment-metrics",children:(0,n.jsxs)("div",{className:"metrics-grid",children:[(0,n.jsxs)("div",{className:"metric-item",children:[(0,n.jsx)("span",{className:"metric-value",children:t.totalBookings}),(0,n.jsx)("span",{className:"metric-label",children:"Total de Agendamentos"})]}),(0,n.jsxs)("div",{className:"metric-item",children:[(0,n.jsxs)("span",{className:"metric-value",children:[t.confirmationRate,"%"]}),(0,n.jsx)("span",{className:"metric-label",children:"Taxa de Confirma\xe7\xe3o"})]}),(0,n.jsxs)("div",{className:"metric-item",children:[(0,n.jsxs)("span",{className:"metric-value",children:[t.noShowRate,"%"]}),(0,n.jsx)("span",{className:"metric-label",children:"Taxa de Falta"})]}),(0,n.jsxs)("div",{className:"metric-item",children:[(0,n.jsxs)("span",{className:"metric-value",children:[t.completionRate,"%"]}),(0,n.jsx)("span",{className:"metric-label",children:"Taxa de Conclus\xe3o"})]})]})})},d=e=>({organic:"Org\xe2nico",social:"Redes Sociais",direct:"Direto",campaigns:"Campanhas"})[e]||e,m=()=>{let[e,t]=(0,i.useState)(null),[a,d]=(0,i.useState)(null),[m,p]=(0,i.useState)(null),[u,h]=(0,i.useState)(null),[v,g]=(0,i.useState)(!0),[f,b]=(0,i.useState)(null);(0,i.useEffect)(()=>{x();let e=setInterval(x,3e5);return()=>clearInterval(e)},[]);let x=async()=>{try{if(g(!0),b(null),!s.Ay.getInstance())throw Error("Analytics not initialized");let e=await _();t(e.funnel),d(e.traffic),p(e.webVitals),h(e.appointments)}catch(e){console.error("Failed to load analytics data:",e),b(e.message)}finally{g(!1)}},_=async()=>{try{var e,t,a,n,i,s,r,c,o,l,d,m,p,u;let[h,v,g,f]=await Promise.all([fetch("/api/analytics/funnel"),fetch("/api/analytics/traffic-sources"),fetch("/api/analytics/web-vitals"),fetch("/api/dashboard/metrics")]),[b,x,_,y]=await Promise.all([h.json(),v.json(),g.json(),f.json()]),w=b.success?{pageViews:(null==(e=b.data.steps[0])?void 0:e.count)||0,contactFormViews:(null==(t=b.data.steps[1])?void 0:t.count)||0,contactFormSubmits:(null==(a=b.data.steps[2])?void 0:a.count)||0,appointmentFormViews:(null==(n=b.data.steps[3])?void 0:n.count)||0,appointmentFormSubmits:(null==(i=b.data.steps[4])?void 0:i.count)||0,appointmentConfirmations:(null==(s=b.data.steps[5])?void 0:s.count)||0,conversionRate:b.data.overall_conversion_rate||0}:j(),N=x.success?x.data.sources:{organic:65,social:20,direct:10,campaigns:5},k=_.success?{lcp:(null==(r=_.data.lcp)?void 0:r.value)||2.1,fid:(null==(c=_.data.fid)?void 0:c.value)||85,cls:(null==(o=_.data.cls)?void 0:o.value)||.08,ttfb:(null==(l=_.data.ttfb)?void 0:l.value)||450}:{lcp:2.1,fid:85,cls:.08,ttfb:450},A=y.success?{totalBookings:(null==(d=y.data.appointments)?void 0:d.total)||0,confirmationRate:(null==(m=y.data.appointments)?void 0:m.confirmation_rate)||0,noShowRate:(null==(p=y.data.appointments)?void 0:p.no_show_rate)||0,completionRate:(null==(u=y.data.appointments)?void 0:u.completion_rate)||0}:{totalBookings:32,confirmationRate:87.5,noShowRate:8.3,completionRate:91.7};return{funnel:w,traffic:N,webVitals:k,appointments:A}}catch(e){return console.error("Error fetching analytics data:",e),y()}},j=()=>({pageViews:1250,contactFormViews:180,contactFormSubmits:45,appointmentFormViews:85,appointmentFormSubmits:32,appointmentConfirmations:28,conversionRate:2.24}),y=()=>({funnel:j(),traffic:{organic:65,social:20,direct:10,campaigns:5},webVitals:{lcp:2.1,fid:85,cls:.08,ttfb:450},appointments:{totalBookings:32,confirmationRate:87.5,noShowRate:8.3,completionRate:91.7}});return v?(0,n.jsx)("div",{className:"analytics-dashboard loading",children:(0,n.jsxs)("div",{className:"loading-spinner",children:[(0,n.jsx)("div",{className:"spinner"}),(0,n.jsx)("p",{children:"Carregando dados de analytics..."})]})}):f?(0,n.jsx)("div",{className:"analytics-dashboard error",children:(0,n.jsxs)("div",{className:"error-message",children:[(0,n.jsx)("h3",{children:"Erro ao carregar analytics"}),(0,n.jsx)("p",{children:f}),(0,n.jsx)("button",{onClick:x,className:"retry-button",children:"Tentar novamente"})]})}):(0,n.jsxs)("div",{className:"analytics-dashboard",children:[(0,n.jsxs)("div",{className:"dashboard-header",children:[(0,n.jsx)("h2",{children:"Analytics Dashboard"}),(0,n.jsx)("button",{onClick:x,className:"refresh-button",children:"Atualizar dados"})]}),(0,n.jsxs)("div",{className:"dashboard-grid",children:[(0,n.jsxs)("div",{className:"dashboard-card funnel-card",children:[(0,n.jsx)("h3",{children:"Funil de Convers\xe3o"}),e&&(0,n.jsx)(r,{data:e})]}),(0,n.jsxs)("div",{className:"dashboard-card traffic-card",children:[(0,n.jsx)("h3",{children:"Fontes de Tr\xe1fego"}),a&&(0,n.jsx)(c,{data:a})]}),(0,n.jsxs)("div",{className:"dashboard-card vitals-card",children:[(0,n.jsx)("h3",{children:"Core Web Vitals"}),m&&(0,n.jsx)(o,{data:m})]}),(0,n.jsxs)("div",{className:"dashboard-card appointments-card",children:[(0,n.jsx)("h3",{children:"M\xe9tricas de Agendamentos"}),u&&(0,n.jsx)(l,{data:u})]})]})]})};var p=a(97355);a(6426),a(12292);let u=()=>{let{trackEvent:e,trackInteraction:t,trackFormView:a,isEnabled:i}=(0,p.st)(),s=n=>{switch(n){case"contact_form_view":a("contact");break;case"appointment_form_view":a("appointment");break;case"button_click":t("click","demo_button",{demo:!0});break;case"page_visit":e("page_visit");break;default:console.log("Unknown event type")}};return(0,n.jsx)("div",{className:"analytics-demo-page",children:(0,n.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"Analytics Integration Demo"}),(0,n.jsxs)("div",{className:"mb-8 p-4 bg-gray-100 rounded-lg",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Analytics Status"}),(0,n.jsxs)("p",{className:"mb-2",children:[(0,n.jsx)("strong",{children:"Status:"})," ",i()?"✅ Enabled":"❌ Disabled"]}),(0,n.jsxs)("p",{className:"text-sm text-gray-600",children:["Analytics tracking is ",i()?"active":"inactive",".",!i()&&" Please accept cookies to enable analytics."]})]}),(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Test Analytics Events"}),(0,n.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,n.jsx)("button",{onClick:()=>s("page_visit"),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Track Page Visit"}),(0,n.jsx)("button",{onClick:()=>s("contact_form_view"),className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"Track Contact Form View"}),(0,n.jsx)("button",{onClick:()=>s("appointment_form_view"),className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700",children:"Track Appointment Form View"}),(0,n.jsx)("button",{onClick:()=>s("button_click"),className:"px-4 py-2 bg-orange-600 text-white rounded hover:bg-orange-700",children:"Track Button Click"})]})]}),(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Analytics Dashboard"}),(0,n.jsx)(m,{})]}),(0,n.jsxs)("div",{className:"bg-blue-50 p-6 rounded-lg",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Implementation Notes"}),(0,n.jsxs)("ul",{className:"list-disc list-inside space-y-2 text-sm",children:[(0,n.jsx)("li",{children:"PostHog analytics integration with LGPD compliance"}),(0,n.jsx)("li",{children:"Conversion funnel tracking: visit → contact → appointment → confirmation"}),(0,n.jsx)("li",{children:"UTM parameter tracking for traffic source analysis"}),(0,n.jsx)("li",{children:"Core Web Vitals monitoring for performance insights"}),(0,n.jsx)("li",{children:"Appointment completion rate tracking"}),(0,n.jsx)("li",{children:"User consent management with cookie banner"}),(0,n.jsx)("li",{children:"Real-time analytics dashboard with API integration"}),(0,n.jsx)("li",{children:"Privacy-first approach - no PII in analytics events"})]})]})]})})}},97355:(e,t,a)=>{"use strict";a.d(t,{No:()=>r,st:()=>s});var n=a(14232),i=a(73205);let s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{trackPageViews:t=!0,trackUTM:s=!0,trackWebVitals:r=!0}=e,c=(0,n.useRef)(!1),o=(0,n.useRef)(!1);(0,n.useEffect)(()=>{t&&!o.current&&(i.Ay.trackPageView(),i.Ay.trackFunnelEvent("page_visit"),o.current=!0)},[t]),(0,n.useEffect)(()=>{s&&!c.current&&(i.Ay.trackUTMParameters(),c.current=!0)},[s]),(0,n.useEffect)(()=>{r&&a.e(788).then(a.bind(a,70788)).then(e=>{let{getCLS:t,getFID:a,getFCP:n,getLCP:s,getTTFB:r}=e;t(i.Ay.trackWebVitals),a(i.Ay.trackWebVitals),n(i.Ay.trackWebVitals),s(i.Ay.trackWebVitals),r(i.Ay.trackWebVitals)}).catch(e=>{console.warn("Failed to load web-vitals:",e)})},[r]);let l=(0,n.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i.Ay.trackFunnelEvent(e,t)},[]),d=(0,n.useCallback)(function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};i.Ay.trackUserInteraction(e,t,a)},[]),m=(0,n.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i.Ay.trackAppointmentMetrics(e,t)},[]);return{trackEvent:l,trackInteraction:d,trackAppointment:m,trackFormView:(0,n.useCallback)(e=>{let t={contact:"contact_form_view",appointment:"appointment_form_view"}[e];t&&i.Ay.trackFunnelEvent(t)},[]),trackFormSubmit:(0,n.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a={contact:"contact_form_submit",appointment:"appointment_form_submit"}[e];if(a){var n;let s={form_type:e,has_name:!!t.name,has_email:!!t.email,has_phone:!!t.phone,message_length:(null==(n=t.message)?void 0:n.length)||0,consent_given:t.consent};i.Ay.trackFunnelEvent(a,s)}},[]),isEnabled:i.Ay.isEnabled}},r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{threshold:a=.5,trackOnce:s=!0}=t,r=(0,n.useRef)(!1),c=(0,n.useRef)(null);return(0,n.useEffect)(()=>{let t=c.current;if(!t||!i.Ay.isEnabled())return;let n=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&t.intersectionRatio>=a&&(!s||!r.current)&&(i.Ay.trackFunnelEvent(e,{visibility_threshold:a,intersection_ratio:t.intersectionRatio}),r.current=!0)})},{threshold:a});return n.observe(t),()=>{n.disconnect()}},[e,a,s]),c}}},e=>{e.O(0,[123,636,6593,8792],()=>e(e.s=8322)),_N_E=e.O()}]);