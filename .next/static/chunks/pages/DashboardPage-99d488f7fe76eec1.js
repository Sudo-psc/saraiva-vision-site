(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1373],{9674:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(56467).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},17734:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(56467).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},18024:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(56467).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},19878:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(56467).A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},21744:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(56467).A)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},30449:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(56467).A)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]])},32566:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/DashboardPage",function(){return t(80346)}])},41399:(e,s,t)=>{"use strict";t.d(s,{As:()=>l}),t(37876);var a=t(14232);t(80369);let r=(0,a.createContext)({}),l=()=>{let e=(0,a.useContext)(r);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},57009:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(56467).A)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},66691:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(56467).A)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},67295:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(56467).A)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},80346:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>ea});var a=t(37876),r=t(14232),l=t(88307),i=t(14952),n=t(41399);let c=e=>{let{children:s,className:t="",...r}=e;return(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm ".concat(t),...r,children:s})},d=e=>{let{children:s,className:t="",...r}=e;return(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 ".concat(t),...r,children:s})},o=e=>{let{children:s,className:t="",...r}=e;return(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 ".concat(t),...r,children:s})},m=e=>{let{children:s,className:t="",...r}=e;return(0,a.jsx)("div",{className:"px-6 py-4 ".concat(t),...r,children:s})};var x=t(99645);let u=e=>{let{children:s,variant:t="default",className:r="",...l}=e;return(0,a.jsx)("div",{className:"p-4 rounded-lg border ".concat((e=>{switch(e){case"destructive":return"bg-red-50 border-red-200 text-red-800";case"warning":return"bg-yellow-50 border-yellow-200 text-yellow-800";case"success":return"bg-green-50 border-green-200 text-green-800";default:return"bg-blue-50 border-blue-200 text-blue-800"}})(t)," ").concat(r),...l,children:s})},h=e=>{let{children:s,className:t="",...r}=e;return(0,a.jsx)("div",{className:"text-sm ".concat(t),...r,children:s})};var g=t(55194),p=t(66691),j=t(19878),y=t(9674),f=t(21744),v=t(67295),b=t(30449),N=t(56467);let w=(0,N.A)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var A=t(18024);let k=(0,N.A)("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),_=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3e4,[s,t]=(0,r.useState)({metrics:null,health:null,queue:null}),[a,l]=(0,r.useState)(!0),[i,n]=(0,r.useState)(null),[c,d]=(0,r.useState)(null),[o,m]=(0,r.useState)(!1),x=(0,r.useRef)(null),u=(0,r.useRef)(null),h=(0,r.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{u.current&&u.current.abort(),u.current=new AbortController,e?m(!0):l(!0),n(null);let[s,a,r]=await Promise.all([fetch("/api/dashboard/metrics",{signal:u.current.signal,headers:{"Cache-Control":"no-cache"}}),fetch("/api/dashboard/health",{signal:u.current.signal,headers:{"Cache-Control":"no-cache"}}),fetch("/api/dashboard/queue",{signal:u.current.signal,headers:{"Cache-Control":"no-cache"}})]);if(!s.ok||!a.ok||!r.ok){let e=[];throw s.ok||e.push("metrics"),a.ok||e.push("health"),r.ok||e.push("queue"),Error("Failed to fetch: ".concat(e.join(", ")))}let[i,c,o]=await Promise.all([s.json(),a.json(),r.json()]);if(!i.success||!c.success||!o.success)throw Error("Invalid response format from API");t({metrics:i.data,health:c.data,queue:o.data}),d(new Date),n(null)}catch(e){"AbortError"!==e.name&&(console.error("Dashboard fetch error:",e),n(e.message))}finally{l(!1),m(!1)}},[]),g=(0,r.useCallback)(()=>{h(!0)},[h]),p=(0,r.useCallback)(()=>{x.current&&clearInterval(x.current),x.current=setInterval(()=>{h(!1)},e)},[h,e]),j=(0,r.useCallback)(()=>{x.current&&(clearInterval(x.current),x.current=null)},[]);return(0,r.useEffect)(()=>(h(!1),p(),()=>{j(),u.current&&u.current.abort()}),[h,p,j]),(0,r.useEffect)(()=>{let e=()=>{document.hidden?j():(h(!1),p())};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[h,p,j]),{data:s,loading:a,error:i,lastUpdated:c,isRefreshing:o,refresh:g,startAutoRefresh:p,stopAutoRefresh:j}},C=e=>{var s,t,r,l,i,n;let{health:x}=e;return(0,a.jsxs)(c,{children:[(0,a.jsx)(d,{children:(0,a.jsxs)(o,{className:"flex items-center gap-2",children:[(0,a.jsx)(k,{className:"h-5 w-5"}),"System Health"]})}),(0,a.jsx)(m,{children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 rounded-full ".concat((e=>{switch(e){case"healthy":return"text-green-600 bg-green-100";case"degraded":return"text-yellow-600 bg-yellow-100";case"unhealthy":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}})(null==x||null==(s=x.overall)?void 0:s.status)),children:[(e=>{switch(e){case"healthy":return(0,a.jsx)(b.A,{className:"h-5 w-5"});case"degraded":return(0,a.jsx)(p.A,{className:"h-5 w-5"});case"unhealthy":return(0,a.jsx)(w,{className:"h-5 w-5"});default:return(0,a.jsx)(A.A,{className:"h-5 w-5"})}})(null==x||null==(t=x.overall)?void 0:t.status),(0,a.jsx)("span",{className:"font-medium capitalize",children:(null==x||null==(r=x.overall)?void 0:r.status)||"Unknown"})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[(null==x||null==(l=x.overall)?void 0:l.upServices)||0,"/",(null==x||null==(i=x.overall)?void 0:i.totalServices)||0," services operational"]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[(null==x||null==(n=x.overall)?void 0:n.uptime)||0,"% uptime"]})]})})]})},S=e=>{let{title:s,value:t,subtitle:r,icon:l,trend:i}=e;return(0,a.jsx)(c,{children:(0,a.jsx)(m,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:s}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:t}),(0,a.jsx)("p",{className:"text-sm ".concat((e=>{switch(e){case"positive":return"text-green-600";case"negative":return"text-red-600";default:return"text-gray-600"}})(i)),children:r})]}),(0,a.jsx)("div",{className:"text-gray-400",children:l})]})})})},E=e=>{let{appointments:s}=e;return(0,a.jsxs)(c,{children:[(0,a.jsx)(d,{children:(0,a.jsx)(o,{children:"Appointment Status (24h)"})}),(0,a.jsx)(m,{children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{children:"Confirmed"}),(0,a.jsx)(x.E,{variant:"success",children:(null==s?void 0:s.confirmed)||0})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{children:"Pending"}),(0,a.jsx)(x.E,{variant:"warning",children:(null==s?void 0:s.pending)||0})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{children:"Cancelled"}),(0,a.jsx)(x.E,{variant:"destructive",children:(null==s?void 0:s.cancelled)||0})]}),(0,a.jsx)("div",{className:"pt-2 border-t",children:(0,a.jsxs)("div",{className:"flex justify-between items-center font-medium",children:[(0,a.jsx)("span",{children:"Conversion Rate"}),(0,a.jsxs)("span",{children:[(null==s?void 0:s.conversionRate)||0,"%"]})]})})]})})]})},U=e=>{var s,t,r,l,i,n,u,h,g,p;let{queue:j}=e;return(0,a.jsxs)(c,{children:[(0,a.jsx)(d,{children:(0,a.jsx)(o,{children:"Message Queue Status"})}),(0,a.jsx)(m,{children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{children:"Pending"}),(0,a.jsx)(x.E,{variant:(null==j||null==(t=j.metrics)||null==(s=t.current)?void 0:s.pending)>10?"warning":"default",children:(null==j||null==(l=j.metrics)||null==(r=l.current)?void 0:r.pending)||0})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{children:"Sent (24h)"}),(0,a.jsx)(x.E,{variant:"success",children:(null==j||null==(n=j.metrics)||null==(i=n.recent24h)?void 0:i.successful)||0})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{children:"Failed (24h)"}),(0,a.jsx)(x.E,{variant:"destructive",children:(null==j||null==(h=j.metrics)||null==(u=h.recent24h)?void 0:u.failed)||0})]}),(0,a.jsx)("div",{className:"pt-2 border-t",children:(0,a.jsxs)("div",{className:"flex justify-between items-center font-medium",children:[(0,a.jsx)("span",{children:"Success Rate"}),(0,a.jsxs)("span",{children:[(null==j||null==(p=j.metrics)||null==(g=p.performance)?void 0:g.successRate)||100,"%"]})]})})]})})]})},q=e=>{var s;let{health:t}=e;return(0,a.jsxs)(c,{children:[(0,a.jsx)(d,{children:(0,a.jsx)(o,{children:"External Services"})}),(0,a.jsx)(m,{children:(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:null==t||null==(s=t.services)?void 0:s.map((e,s)=>(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 border rounded",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.service}),e.responseTime&&(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:[e.responseTime,"ms"]}),e.error&&(0,a.jsx)("div",{className:"text-sm text-red-500",children:e.error})]}),(e=>{switch(e){case"up":return(0,a.jsx)(x.E,{variant:"success",children:"Online"});case"down":return(0,a.jsx)(x.E,{variant:"destructive",children:"Offline"});default:return(0,a.jsx)(x.E,{variant:"secondary",children:"Unknown"})}})(e.status)]},s))})})]})},M=e=>{let{alerts:s}=e;return(0,a.jsxs)(c,{children:[(0,a.jsx)(d,{children:(0,a.jsxs)(o,{className:"flex items-center gap-2",children:[(0,a.jsx)(p.A,{className:"h-5 w-5"}),"Active Alerts"]})}),(0,a.jsx)(m,{children:(0,a.jsx)("div",{className:"space-y-3",children:s.map((e,s)=>(0,a.jsx)(u,{variant:"error"===e.type?"destructive":"default",children:(0,a.jsx)(h,{children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{children:e.message}),(0,a.jsx)(x.E,{variant:"outline",children:e.severity})]})})},s))})})]})},L=()=>{var e,s,t,r,l,i,n,c,d,o,m;let{data:{metrics:x,health:b,queue:N},loading:w,error:A,lastUpdated:k,isRefreshing:L,refresh:P}=_();return w?(0,a.jsxs)("div",{className:"flex items-center justify-center min-h-screen",children:[(0,a.jsx)(g.A,{className:"h-8 w-8 animate-spin"}),(0,a.jsx)("span",{className:"ml-2",children:"Loading dashboard..."})]}):A?(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)(u,{variant:"destructive",children:[(0,a.jsx)(p.A,{className:"h-4 w-4"}),(0,a.jsxs)(h,{children:["Failed to load dashboard: ",A,(0,a.jsx)("button",{onClick:P,className:"ml-2 underline hover:no-underline",children:"Retry"})]})]})}):(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Operational Dashboard"}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("button",{onClick:P,disabled:L,className:"flex items-center gap-2 px-3 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,a.jsx)(j.A,{className:"h-4 w-4 ".concat(L?"animate-spin":"")}),L?"Refreshing...":"Refresh"]}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["Last updated: ",null==k?void 0:k.toLocaleTimeString()]})]})]}),(0,a.jsx)(C,{health:b}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,a.jsx)(S,{title:"Contacts (24h)",value:(null==x||null==(e=x.contacts)?void 0:e.total24h)||0,subtitle:"".concat((null==x||null==(s=x.contacts)?void 0:s.hourlyRate)||0,"/hour avg"),icon:(0,a.jsx)(y.A,{className:"h-4 w-4"}),trend:"neutral"}),(0,a.jsx)(S,{title:"Appointments (24h)",value:(null==x||null==(t=x.appointments)?void 0:t.total24h)||0,subtitle:"".concat((null==x||null==(r=x.appointments)?void 0:r.conversionRate)||0,"% conversion"),icon:(0,a.jsx)(f.A,{className:"h-4 w-4"}),trend:"neutral"}),(0,a.jsx)(S,{title:"Message Delivery",value:"".concat((null==x||null==(l=x.messaging)?void 0:l.deliveryRate)||100,"%"),subtitle:"".concat((null==x||null==(i=x.messaging)?void 0:i.sent)||0,"/").concat((null==x||null==(n=x.messaging)?void 0:n.totalMessages)||0," sent"),icon:(0,a.jsx)(v.A,{className:"h-4 w-4"}),trend:(null==x||null==(c=x.messaging)?void 0:c.deliveryRate)>=95?"positive":"negative"}),(0,a.jsx)(S,{title:"System Errors",value:(null==x||null==(d=x.system)?void 0:d.errors24h)||0,subtitle:"".concat((null==x||null==(o=x.system)?void 0:o.errorRate)||0,"/hour avg"),icon:(0,a.jsx)(p.A,{className:"h-4 w-4"}),trend:(null==x||null==(m=x.system)?void 0:m.errors24h)===0?"positive":"negative"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsx)(E,{appointments:null==x?void 0:x.appointments}),(0,a.jsx)(U,{queue:N})]}),(0,a.jsx)(q,{health:b}),(null==N?void 0:N.alerts)&&N.alerts.length>0&&(0,a.jsx)(M,{alerts:N.alerts})]})};var P=t(80369),R=t(51165),D=t(97842),z=t(21271),I=t(57009),O=t(78539),F=t(39393),T=t(77711),V=t(30359);let B=e=>{let{isOpen:s,onClose:t,onUserCreated:l}=e,[i,n]=(0,r.useState)({email:"",password:"",confirmPassword:"",fullName:"",role:"admin"}),[c,d]=(0,r.useState)(!1),[o,m]=(0,r.useState)(!1),[x,u]=(0,r.useState)(!1),[h,p]=(0,r.useState)(""),[j,y]=(0,r.useState)(""),f=e=>{let{name:s,value:t}=e.target;n(e=>({...e,[s]:t})),h&&p(""),j&&y("")},v=async e=>{if(e.preventDefault(),i.email&&i.password&&i.fullName?i.password.length<8?(p("A senha deve ter pelo menos 8 caracteres"),!1):i.password!==i.confirmPassword?(p("As senhas n\xe3o coincidem"),!1):!!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i.email)||(p("Email inv\xe1lido"),!1):(p("Todos os campos obrigat\xf3rios devem ser preenchidos"),!1)){u(!0),p(""),y("");try{let{data:e,error:s}=await P.E.auth.admin.createUser({email:i.email,password:i.password,email_confirm:!0,user_metadata:{full_name:i.fullName}});if(s)throw s;let{error:a}=await P.E.from("profiles").insert({id:e.user.id,email:i.email,full_name:i.fullName,role:i.role,is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()});if(a)throw await P.E.auth.admin.deleteUser(e.user.id),a;await P.E.rpc("log_event",{p_event_type:"admin_user_created",p_event_data:{created_user_id:e.user.id,created_user_email:i.email,created_user_role:i.role},p_severity:"info",p_source:"user_management"}),y("Usu\xe1rio criado com sucesso!"),n({email:"",password:"",confirmPassword:"",fullName:"",role:"admin"}),l&&l({id:e.user.id,email:i.email,full_name:i.fullName,role:i.role,is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),last_login:null}),setTimeout(()=>{t(),y("")},2e3)}catch(e){var s,a;console.error("Error creating user:",e),(null==(s=e.message)?void 0:s.includes("User already registered"))?p("Este email j\xe1 est\xe1 registrado no sistema"):(null==(a=e.message)?void 0:a.includes("Password should be at least"))?p("A senha deve ter pelo menos 6 caracteres"):p("Erro ao criar usu\xe1rio. Tente novamente.")}finally{u(!1)}}},N=()=>{x||(n({email:"",password:"",confirmPassword:"",fullName:"",role:"admin"}),p(""),y(""),t())};return s?(0,a.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,a.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:N}),(0,a.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,a.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-blue-100",children:(0,a.jsx)(R.A,{className:"h-6 w-6 text-blue-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Criar Novo Usu\xe1rio Admin"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Adicione um novo administrador ao sistema"})]})]}),(0,a.jsx)("button",{onClick:N,disabled:x,className:"text-gray-400 hover:text-gray-600 transition-colors disabled:opacity-50",children:(0,a.jsx)(D.A,{className:"h-6 w-6"})})]}),h&&(0,a.jsxs)("div",{className:"mb-4 flex items-start p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,a.jsx)(z.A,{className:"h-5 w-5 text-red-400 mr-2 mt-0.5 flex-shrink-0"}),(0,a.jsx)("div",{className:"text-sm text-red-700",children:h})]}),j&&(0,a.jsxs)("div",{className:"mb-4 flex items-start p-3 bg-green-50 border border-green-200 rounded-lg",children:[(0,a.jsx)(b.A,{className:"h-5 w-5 text-green-400 mr-2 mt-0.5 flex-shrink-0"}),(0,a.jsx)("div",{className:"text-sm text-green-700",children:j})]}),(0,a.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"fullName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome Completo *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(R.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,a.jsx)("input",{type:"text",id:"fullName",name:"fullName",value:i.fullName,onChange:f,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Nome do administrador",required:!0,disabled:x})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(I.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,a.jsx)("input",{type:"email",id:"email",name:"email",value:i.email,onChange:f,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"admin@saraivavision.com.br",required:!0,disabled:x})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-1",children:"Fun\xe7\xe3o *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(O.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,a.jsxs)("select",{id:"role",name:"role",value:i.role,onChange:f,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,disabled:x,children:[(0,a.jsx)("option",{value:"admin",children:"Admin"}),(0,a.jsx)("option",{value:"super_admin",children:"Super Admin"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Senha *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(F.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,a.jsx)("input",{type:c?"text":"password",id:"password",name:"password",value:i.password,onChange:f,className:"w-full pl-10 pr-12 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"M\xednimo 8 caracteres",required:!0,disabled:x,minLength:8}),(0,a.jsx)("button",{type:"button",onClick:()=>d(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",disabled:x,children:c?(0,a.jsx)(T.A,{className:"w-4 h-4"}):(0,a.jsx)(V.A,{className:"w-4 h-4"})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirmar Senha *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(F.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,a.jsx)("input",{type:o?"text":"password",id:"confirmPassword",name:"confirmPassword",value:i.confirmPassword,onChange:f,className:"w-full pl-10 pr-12 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Repita a senha",required:!0,disabled:x}),(0,a.jsx)("button",{type:"button",onClick:()=>m(!o),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",disabled:x,children:o?(0,a.jsx)(T.A,{className:"w-4 h-4"}):(0,a.jsx)(V.A,{className:"w-4 h-4"})})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,a.jsx)("button",{type:"submit",onClick:v,disabled:x,className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:x?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Criando..."]}):"Criar Usu\xe1rio"}),(0,a.jsx)("button",{type:"button",onClick:N,disabled:x,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50",children:"Cancelar"})]})]})]})}):null},H=(0,N.A)("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),X=(0,N.A)("ShieldX",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m14.5 9-5 5",key:"1m49dw"}],["path",{d:"m9.5 9 5 5",key:"wyx7zg"}]]),Y=(0,N.A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var K=t(17734);let J=()=>{let{profile:e,isSuperAdmin:s}=(0,n.As)(),{loading:t,error:l,listUsers:i,updateUserRole:c,toggleUserStatus:d,clearError:o}=(()=>{let{user:e,profile:s}=(0,n.As)(),[t,a]=(0,r.useState)(!1),[l,i]=(0,r.useState)(null),c=(0,r.useCallback)(async function(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e||!s)throw Error("User not authenticated");let r=await fetch("/api/admin/auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:t,requesterId:e.id,...a})}),l=await r.json();if(!l.success){var i;throw Error((null==(i=l.error)?void 0:i.message)||"Operation failed")}return l.data},[e,s]),d=(0,r.useCallback)(async e=>{try{return a(!0),i(null),await c("verify_admin",{userId:e})}catch(e){throw i(e.message),e}finally{a(!1)}},[c]),o=(0,r.useCallback)(async e=>{try{return a(!0),i(null),(await c("get_user_profile",{userId:e})).profile}catch(e){throw i(e.message),e}finally{a(!1)}},[c]),m=(0,r.useCallback)(async(e,s)=>{try{return a(!0),i(null),(await c("update_user_role",{userId:e,newRole:s})).profile}catch(e){throw i(e.message),e}finally{a(!1)}},[c]),x=(0,r.useCallback)(async e=>{try{return a(!0),i(null),(await c("toggle_user_status",{userId:e})).profile}catch(e){throw i(e.message),e}finally{a(!1)}},[c]),u=(0,r.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return a(!0),i(null),(await c("list_users",{filters:e})).users}catch(e){throw i(e.message),e}finally{a(!1)}},[c]);return{loading:t,error:l,clearError:(0,r.useCallback)(()=>{i(null)},[]),verifyAdminAccess:d,getUserProfile:o,updateUserRole:m,toggleUserStatus:x,listUsers:u}})(),[m,x]=(0,r.useState)([]),[u,h]=(0,r.useState)(!0),[g,j]=(0,r.useState)(""),[f,v]=(0,r.useState)(""),[N,w]=(0,r.useState)("all"),[k,_]=(0,r.useState)("all"),[C,S]=(0,r.useState)(!1),[E,U]=(0,r.useState)(null);(0,r.useEffect)(()=>{q()},[]),(0,r.useEffect)(()=>{l&&j(l)},[l]);let q=async()=>{try{h(!0),j(""),o();let e=await i();x(e||[])}catch(e){console.error("Error fetching users:",e),j("Failed to load users")}finally{h(!1)}},M=async(e,s)=>{try{j(""),o();let t=await c(e,s);x(s=>s.map(s=>s.id===e?t:s))}catch(e){console.error("Error updating user role:",e),j("Failed to update user role")}},L=async(e,s)=>{try{j(""),o();let s=await d(e);x(t=>t.map(t=>t.id===e?s:t))}catch(e){console.error("Error updating user status:",e),j("Failed to update user status")}},P=m.filter(e=>{let s=(e.email||"").toLowerCase().includes(f.toLowerCase())||(e.full_name||"").toLowerCase().includes(f.toLowerCase()),t="all"===N||e.role===N,a="all"===k||"active"===k&&e.is_active||"inactive"===k&&!e.is_active;return s&&t&&a});return u||t?(0,a.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,a.jsx)("span",{className:"ml-2",children:"Loading users..."})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"User Management"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Manage admin users and permissions"})]}),s()&&(0,a.jsxs)("button",{onClick:()=>S(!0),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[(0,a.jsx)(Y,{className:"h-4 w-4 mr-2"}),"Add User"]})]}),g&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(p.A,{className:"h-5 w-5 text-red-400 mr-2"}),(0,a.jsx)("div",{className:"text-sm text-red-700",children:g})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(K.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Search users...",className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:f,onChange:e=>v(e.target.value)})]}),(0,a.jsx)("div",{children:(0,a.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:N,onChange:e=>w(e.target.value),children:[(0,a.jsx)("option",{value:"all",children:"All Roles"}),(0,a.jsx)("option",{value:"user",children:"User"}),(0,a.jsx)("option",{value:"admin",children:"Admin"}),(0,a.jsx)("option",{value:"super_admin",children:"Super Admin"})]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:k,onChange:e=>_(e.target.value),children:[(0,a.jsx)("option",{value:"all",children:"All Status"}),(0,a.jsx)("option",{value:"active",children:"Active"}),(0,a.jsx)("option",{value:"inactive",children:"Inactive"})]})})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Login"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),s()&&(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:P.map(t=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:(0,a.jsx)(y.A,{className:"h-5 w-5 text-blue-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:t.full_name||"No name"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:t.email})]})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(e=>{let s={super_admin:"bg-red-100 text-red-800 border-red-200",admin:"bg-blue-100 text-blue-800 border-blue-200",user:"bg-gray-100 text-gray-800 border-gray-200"};return(0,a.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ".concat(s[e]||s.user),children:[(e=>{switch(e){case"super_admin":return(0,a.jsx)(H,{className:"h-4 w-4 text-red-600"});case"admin":return(0,a.jsx)(O.A,{className:"h-4 w-4 text-blue-600"});default:return(0,a.jsx)(X,{className:"h-4 w-4 text-gray-400"})}})(e),(0,a.jsx)("span",{className:"ml-1 capitalize",children:(e||"user").replace("_"," ")})]})})(t.role)}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(e=>(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat(e?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"),children:e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(b.A,{className:"h-3 w-3 mr-1"}),"Active"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.A,{className:"h-3 w-3 mr-1"}),"Inactive"]})}))(t.is_active)}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.last_login?new Date(t.last_login).toLocaleDateString():(0,a.jsx)("span",{className:"text-gray-400",children:"Never"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(t.created_at).toLocaleDateString()}),s()&&(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[(0,a.jsxs)("select",{value:t.role,onChange:e=>M(t.id,e.target.value),className:"text-xs border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:t.id===e.id,children:[(0,a.jsx)("option",{value:"user",children:"User"}),(0,a.jsx)("option",{value:"admin",children:"Admin"}),(0,a.jsx)("option",{value:"super_admin",children:"Super Admin"})]}),(0,a.jsx)("button",{onClick:()=>L(t.id,t.is_active),disabled:t.id===e.id,className:"p-1 rounded ".concat(t.is_active?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"," disabled:opacity-50 disabled:cursor-not-allowed"),title:t.is_active?"Deactivate user":"Activate user",children:t.is_active?(0,a.jsx)(V.A,{className:"h-4 w-4"}):(0,a.jsx)(T.A,{className:"h-4 w-4"})})]})})]},t.id))})]})}),0===P.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(y.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500",children:"No users found matching your criteria"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(y.A,{className:"h-8 w-8 text-blue-600"}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total Users"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:m.length})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(O.A,{className:"h-8 w-8 text-green-600"}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Admins"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:m.filter(e=>"admin"===e.role||"super_admin"===e.role).length})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(b.A,{className:"h-8 w-8 text-green-600"}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Active"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:m.filter(e=>e.is_active).length})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(A.A,{className:"h-8 w-8 text-yellow-600"}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Recent Logins"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:m.filter(e=>e.last_login&&new Date(e.last_login)>new Date(Date.now()-6048e5)).length})]})]})})]}),(0,a.jsx)(B,{isOpen:C,onClose:()=>S(!1),onUserCreated:e=>{x(s=>[e,...s]),S(!1)}})]})},Q=e=>{let{children:s,requiredRole:t="user",requireDashboardAccess:r=!1,fallbackPath:i="/admin/login"}=e,{user:c,profile:d,loading:o,hasRole:m,canAccessDashboard:x,isAuthenticated:u,isProfileLoaded:h}=(0,n.As)(),j=(0,l.zy)();return o||u&&!h?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(g.A,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-blue-600"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Verifying access..."})]})}):u?d&&d.is_active?m(t)?r&&!x()?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,a.jsxs)("div",{className:"max-w-md w-full bg-white rounded-lg shadow-md p-6 text-center",children:[(0,a.jsx)(O.A,{className:"h-12 w-12 text-yellow-500 mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Dashboard Access Restricted"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"You don't have access to the admin dashboard. Admin role is required."}),(0,a.jsx)(l.C5,{to:"/",replace:!0})]})}):s:(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,a.jsxs)("div",{className:"max-w-md w-full bg-white rounded-lg shadow-md p-6 text-center",children:[(0,a.jsx)(O.A,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Access Denied"}),(0,a.jsxs)("p",{className:"text-gray-600 mb-4",children:["You don't have the required permissions to access this page. Required role: ",(0,a.jsx)("span",{className:"font-medium",children:t})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mb-4",children:["Your current role: ",(0,a.jsx)("span",{className:"font-medium",children:d.role})]}),(0,a.jsx)(l.C5,{to:"/",replace:!0})]})}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,a.jsxs)("div",{className:"max-w-md w-full bg-white rounded-lg shadow-md p-6 text-center",children:[(0,a.jsx)(p.A,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Account Inactive"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"Your account is not active or could not be loaded. Please contact an administrator for assistance."}),(0,a.jsx)("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Retry"})]})}):(0,a.jsx)(l.C5,{to:i,state:{from:j.pathname},replace:!0})},Z=(0,N.A)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);var $=t(89903),G=t(87249);let W=(0,N.A)("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),ee=(0,N.A)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),es=e=>{var s;let{navigation:t,profile:r,onLogout:l}=e;return(0,a.jsxs)("div",{className:"flex flex-col flex-grow bg-white border-r border-gray-200 pt-5 pb-4 overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-center flex-shrink-0 px-4",children:[(0,a.jsx)("div",{className:"h-8 w-8 bg-blue-600 rounded-lg flex items-center justify-center",children:(0,a.jsx)(O.A,{className:"h-5 w-5 text-white"})}),(0,a.jsx)("span",{className:"ml-2 text-lg font-semibold text-gray-900",children:"Admin Panel"})]}),(0,a.jsx)("nav",{className:"mt-8 flex-1 px-2 space-y-1",children:t.map(e=>{let s=e.icon;return(0,a.jsxs)(i.N_,{to:e.href,className:"group flex items-center px-2 py-2 text-sm font-medium rounded-md transition-colors ".concat(e.current?"bg-blue-100 text-blue-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),children:[(0,a.jsx)(s,{className:"mr-3 flex-shrink-0 h-5 w-5 ".concat(e.current?"text-blue-500":"text-gray-400 group-hover:text-gray-500")}),e.name]},e.name)})}),(0,a.jsx)("div",{className:"flex-shrink-0 border-t border-gray-200 p-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:(0,a.jsx)(y.A,{className:"h-5 w-5 text-blue-600"})}),(0,a.jsxs)("div",{className:"ml-3 flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:(null==r?void 0:r.full_name)||"Admin"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 capitalize",children:null==r||null==(s=r.role)?void 0:s.replace("_"," ")})]}),(0,a.jsx)("button",{onClick:l,className:"ml-2 p-2 text-gray-400 hover:text-gray-600 transition-colors",title:"Sign out",children:(0,a.jsx)(ee,{className:"h-4 w-4"})})]})})]})},et=()=>(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Settings"}),(0,a.jsx)("p",{className:"text-gray-600",children:"System configuration and preferences"})]}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)($.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Settings Panel"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Settings configuration will be implemented in a future update."})]})})]}),ea=()=>{let{user:e,profile:s,signOut:t,isAdmin:i,isSuperAdmin:c}=(0,n.As)(),[d,o]=(0,r.useState)(!1),m=(0,l.zy)(),x=async()=>{try{await t()}catch(e){console.error("Logout error:",e)}},u=[{name:"Dashboard",href:"/admin/dashboard",icon:Z,current:"/admin/dashboard"===m.pathname},...c()?[{name:"User Management",href:"/admin/users",icon:y.A,current:"/admin/users"===m.pathname}]:[],{name:"Settings",href:"/admin/settings",icon:$.A,current:"/admin/settings"===m.pathname}];return(0,a.jsx)(Q,{requiredRole:"admin",requireDashboardAccess:!0,children:(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsxs)("div",{className:"fixed inset-0 flex z-40 md:hidden ".concat(d?"":"hidden"),children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75",onClick:()=>o(!1)}),(0,a.jsxs)("div",{className:"relative flex-1 flex flex-col max-w-xs w-full bg-white",children:[(0,a.jsx)("div",{className:"absolute top-0 right-0 -mr-12 pt-2",children:(0,a.jsx)("button",{className:"ml-1 flex items-center justify-center h-10 w-10 rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white",onClick:()=>o(!1),children:(0,a.jsx)(D.A,{className:"h-6 w-6 text-white"})})}),(0,a.jsx)(es,{navigation:u,profile:s,onLogout:x})]})]}),(0,a.jsx)("div",{className:"hidden md:flex md:w-64 md:flex-col md:fixed md:inset-y-0",children:(0,a.jsx)(es,{navigation:u,profile:s,onLogout:x})}),(0,a.jsxs)("div",{className:"md:pl-64 flex flex-col flex-1",children:[(0,a.jsx)("div",{className:"sticky top-0 z-10 md:hidden pl-1 pt-1 sm:pl-3 sm:pt-3 bg-gray-50",children:(0,a.jsx)("button",{className:"-ml-0.5 -mt-0.5 h-12 w-12 inline-flex items-center justify-center rounded-md text-gray-500 hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500",onClick:()=>o(!0),children:(0,a.jsx)(G.A,{className:"h-6 w-6"})})}),(0,a.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center py-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"Saraiva Vision - Admin Dashboard"}),(null==s?void 0:s.role)&&(0,a.jsxs)("span",{className:"ml-3 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[(0,a.jsx)(O.A,{className:"h-3 w-3 mr-1"}),s.role.replace("_"," ").toUpperCase()]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("button",{className:"p-2 text-gray-400 hover:text-gray-500 relative",children:[(0,a.jsx)(W,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"absolute top-0 right-0 block h-2 w-2 rounded-full bg-red-400 ring-2 ring-white"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:(null==s?void 0:s.full_name)||"Admin User"}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:null==e?void 0:e.email})]}),(0,a.jsx)("div",{className:"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center",children:(0,a.jsx)(y.A,{className:"h-4 w-4 text-blue-600"})})]})]})]})})}),(0,a.jsx)("main",{className:"flex-1",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)(l.BV,{children:[(0,a.jsx)(l.qh,{path:"/",element:(0,a.jsx)(l.C5,{to:"/admin/dashboard",replace:!0})}),(0,a.jsx)(l.qh,{path:"/dashboard",element:(0,a.jsx)(L,{})}),c()&&(0,a.jsx)(l.qh,{path:"/users",element:(0,a.jsx)(J,{})}),(0,a.jsx)(l.qh,{path:"/settings",element:(0,a.jsx)(et,{})}),(0,a.jsx)(l.qh,{path:"*",element:(0,a.jsx)(l.C5,{to:"/admin/dashboard",replace:!0})})]})})})]})]})})}},80369:(e,s,t)=>{"use strict";t.d(s,{E:()=>c});var a=t(27797),r=t(65364);let l=r.env.NEXT_PUBLIC_SUPABASE_URL,i=r.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,n=r.env.SUPABASE_SERVICE_ROLE_KEY;(0,a.UU)(l,i);let c=(0,a.UU)(l,n,{auth:{autoRefreshToken:!1,persistSession:!1}})},87249:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(56467).A)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]])},89903:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(56467).A)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},97842:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(56467).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},99645:(e,s,t)=>{"use strict";t.d(s,{E:()=>r});var a=t(37876);t(14232);let r=e=>{let{children:s,variant:t="default",className:r="",...l}=e;return(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ".concat((e=>{switch(e){case"success":return"bg-green-100 text-green-800 border-green-200";case"warning":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"destructive":return"bg-red-100 text-red-800 border-red-200";case"outline":return"bg-transparent text-gray-700 border-gray-300";case"secondary":return"bg-gray-100 text-gray-800 border-gray-200";default:return"bg-blue-100 text-blue-800 border-blue-200"}})(t)," ").concat(r),...l,children:s})}}},e=>{e.O(0,[3796,8307,4952,8220,1112,636,6593,8792],()=>e(e.s=32566)),_N_E=e.O()}]);