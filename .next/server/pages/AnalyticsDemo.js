(()=>{var a={};a.id=8317,a.ids=[3220,8317],a.modules={8732:a=>{"use strict";a.exports=require("react/jsx-runtime")},32591:(a,b,c)=>{"use strict";c.d(b,{Ay:()=>d}),c(74120);let d={initialize:(a,b=!1)=>{console.warn("PostHog API key not provided or running on server")},enable:()=>{console.warn("Analytics not initialized")},disable:()=>{},trackFunnelEvent:(a,b={})=>{},trackUTMParameters:()=>{},trackWebVitals:a=>{},trackPageView:(a=null)=>{},trackUserInteraction:(a,b,c={})=>{},trackAppointmentMetrics:(a,b={})=>{},getInstance:()=>null,isEnabled:()=>!1}},33873:a=>{"use strict";a.exports=require("path")},40361:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},46060:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external.js")},62441:(a,b,c)=>{"use strict";c.d(b,{No:()=>g,st:()=>f});var d=c(82015),e=c(32591);let f=(a={})=>{let{trackPageViews:b=!0,trackUTM:c=!0,trackWebVitals:f=!0}=a,g=(0,d.useRef)(!1),h=(0,d.useRef)(!1);(0,d.useEffect)(()=>{b&&!h.current&&(e.Ay.trackPageView(),e.Ay.trackFunnelEvent("page_visit"),h.current=!0)},[b]),(0,d.useEffect)(()=>{c&&!g.current&&(e.Ay.trackUTMParameters(),g.current=!0)},[c]),(0,d.useEffect)(()=>{},[f]);let i=(0,d.useCallback)((a,b={})=>{e.Ay.trackFunnelEvent(a,b)},[]),j=(0,d.useCallback)((a,b,c={})=>{e.Ay.trackUserInteraction(a,b,c)},[]),k=(0,d.useCallback)((a,b={})=>{e.Ay.trackAppointmentMetrics(a,b)},[]);return{trackEvent:i,trackInteraction:j,trackAppointment:k,trackFormView:(0,d.useCallback)(a=>{let b={contact:"contact_form_view",appointment:"appointment_form_view"}[a];b&&e.Ay.trackFunnelEvent(b)},[]),trackFormSubmit:(0,d.useCallback)((a,b={})=>{let c={contact:"contact_form_submit",appointment:"appointment_form_submit"}[a];if(c){let d={form_type:a,has_name:!!b.name,has_email:!!b.email,has_phone:!!b.phone,message_length:b.message?.length||0,consent_given:b.consent};e.Ay.trackFunnelEvent(c,d)}},[]),isEnabled:e.Ay.isEnabled}},g=(a,b={})=>{let{threshold:c=.5,trackOnce:f=!0}=b,g=(0,d.useRef)(!1),h=(0,d.useRef)(null);return(0,d.useEffect)(()=>{let b=h.current;if(!b||!e.Ay.isEnabled())return;let d=new IntersectionObserver(b=>{b.forEach(b=>{b.isIntersecting&&b.intersectionRatio>=c&&(!f||!g.current)&&(e.Ay.trackFunnelEvent(a,{visibility_threshold:c,intersection_ratio:b.intersectionRatio}),g.current=!0)})},{threshold:c});return d.observe(b),()=>{d.disconnect()}},[a,c,f]),h}},67009:()=>{},72113:(a,b,c)=>{"use strict";c.r(b),c.d(b,{config:()=>B,default:()=>x,getServerSideProps:()=>A,getStaticPaths:()=>z,getStaticProps:()=>y,handler:()=>J,reportWebVitals:()=>C,routeModule:()=>I,unstable_getServerProps:()=>G,unstable_getServerSideProps:()=>H,unstable_getStaticParams:()=>F,unstable_getStaticPaths:()=>E,unstable_getStaticProps:()=>D});var d={};c.r(d),c.d(d,{default:()=>v});var e=c(63885),f=c(80237),g=c(81413),h=c(65611),i=c.n(h),j=c(625),k=c.n(j),l=c(8732),m=c(82015),n=c(32591);let o=({data:a})=>{let b=[{name:"Visitas",value:a.pageViews,percentage:100},{name:"Visualiza\xe7\xf5es do Formul\xe1rio de Contato",value:a.contactFormViews,percentage:(a.contactFormViews/a.pageViews*100).toFixed(1)},{name:"Envios do Formul\xe1rio de Contato",value:a.contactFormSubmits,percentage:(a.contactFormSubmits/a.pageViews*100).toFixed(1)},{name:"Visualiza\xe7\xf5es do Agendamento",value:a.appointmentFormViews,percentage:(a.appointmentFormViews/a.pageViews*100).toFixed(1)},{name:"Agendamentos Enviados",value:a.appointmentFormSubmits,percentage:(a.appointmentFormSubmits/a.pageViews*100).toFixed(1)},{name:"Agendamentos Confirmados",value:a.appointmentConfirmations,percentage:(a.appointmentConfirmations/a.pageViews*100).toFixed(1)}];return(0,l.jsxs)("div",{className:"funnel-visualization",children:[(0,l.jsxs)("div",{className:"conversion-rate",children:[(0,l.jsxs)("span",{className:"rate-value",children:[a.conversionRate,"%"]}),(0,l.jsx)("span",{className:"rate-label",children:"Taxa de Convers\xe3o"})]}),(0,l.jsx)("div",{className:"funnel-steps",children:b.map((a,b)=>(0,l.jsx)("div",{className:"funnel-step",children:(0,l.jsx)("div",{className:"step-bar",style:{width:`${a.percentage}%`},children:(0,l.jsxs)("div",{className:"step-content",children:[(0,l.jsx)("span",{className:"step-name",children:a.name}),(0,l.jsxs)("span",{className:"step-value",children:[a.value," (",a.percentage,"%)"]})]})})},b))})]})},p=({data:a})=>(Object.values(a).reduce((a,b)=>a+b,0),(0,l.jsx)("div",{className:"traffic-sources",children:(0,l.jsx)("div",{className:"sources-list",children:Object.entries(a).map(([a,b])=>(0,l.jsxs)("div",{className:"source-item",children:[(0,l.jsxs)("div",{className:"source-info",children:[(0,l.jsx)("span",{className:"source-name",children:s(a)}),(0,l.jsxs)("span",{className:"source-percentage",children:[b,"%"]})]}),(0,l.jsx)("div",{className:"source-bar",children:(0,l.jsx)("div",{className:`source-fill source-${a}`,style:{width:`${b}%`}})})]},a))})})),q=({data:a})=>{let b=(a,b)=>{let c={lcp:{good:2.5,poor:4},fid:{good:100,poor:300},cls:{good:.1,poor:.25},ttfb:{good:600,poor:1500}}[a];return b<=c.good?"good":b<=c.poor?"needs-improvement":"poor"};return(0,l.jsx)("div",{className:"web-vitals",children:(0,l.jsxs)("div",{className:"vitals-grid",children:[(0,l.jsxs)("div",{className:`vital-item ${b("lcp",a.lcp)}`,children:[(0,l.jsx)("span",{className:"vital-label",children:"LCP"}),(0,l.jsxs)("span",{className:"vital-value",children:[a.lcp,"s"]})]}),(0,l.jsxs)("div",{className:`vital-item ${b("fid",a.fid)}`,children:[(0,l.jsx)("span",{className:"vital-label",children:"FID"}),(0,l.jsxs)("span",{className:"vital-value",children:[a.fid,"ms"]})]}),(0,l.jsxs)("div",{className:`vital-item ${b("cls",a.cls)}`,children:[(0,l.jsx)("span",{className:"vital-label",children:"CLS"}),(0,l.jsx)("span",{className:"vital-value",children:a.cls})]}),(0,l.jsxs)("div",{className:`vital-item ${b("ttfb",a.ttfb)}`,children:[(0,l.jsx)("span",{className:"vital-label",children:"TTFB"}),(0,l.jsxs)("span",{className:"vital-value",children:[a.ttfb,"ms"]})]})]})})},r=({data:a})=>(0,l.jsx)("div",{className:"appointment-metrics",children:(0,l.jsxs)("div",{className:"metrics-grid",children:[(0,l.jsxs)("div",{className:"metric-item",children:[(0,l.jsx)("span",{className:"metric-value",children:a.totalBookings}),(0,l.jsx)("span",{className:"metric-label",children:"Total de Agendamentos"})]}),(0,l.jsxs)("div",{className:"metric-item",children:[(0,l.jsxs)("span",{className:"metric-value",children:[a.confirmationRate,"%"]}),(0,l.jsx)("span",{className:"metric-label",children:"Taxa de Confirma\xe7\xe3o"})]}),(0,l.jsxs)("div",{className:"metric-item",children:[(0,l.jsxs)("span",{className:"metric-value",children:[a.noShowRate,"%"]}),(0,l.jsx)("span",{className:"metric-label",children:"Taxa de Falta"})]}),(0,l.jsxs)("div",{className:"metric-item",children:[(0,l.jsxs)("span",{className:"metric-value",children:[a.completionRate,"%"]}),(0,l.jsx)("span",{className:"metric-label",children:"Taxa de Conclus\xe3o"})]})]})}),s=a=>({organic:"Org\xe2nico",social:"Redes Sociais",direct:"Direto",campaigns:"Campanhas"})[a]||a,t=()=>{let[a,b]=(0,m.useState)(null),[c,d]=(0,m.useState)(null),[e,f]=(0,m.useState)(null),[g,h]=(0,m.useState)(null),[i,j]=(0,m.useState)(!0),[k,s]=(0,m.useState)(null);(0,m.useEffect)(()=>{t();let a=setInterval(t,3e5);return()=>clearInterval(a)},[]);let t=async()=>{try{if(j(!0),s(null),!n.Ay.getInstance())throw Error("Analytics not initialized");let a=await u();b(a.funnel),d(a.traffic),f(a.webVitals),h(a.appointments)}catch(a){console.error("Failed to load analytics data:",a),s(a.message)}finally{j(!1)}},u=async()=>{try{let[a,b,c,d]=await Promise.all([fetch("/api/analytics/funnel"),fetch("/api/analytics/traffic-sources"),fetch("/api/analytics/web-vitals"),fetch("/api/dashboard/metrics")]),[e,f,g,h]=await Promise.all([a.json(),b.json(),c.json(),d.json()]),i=e.success?{pageViews:e.data.steps[0]?.count||0,contactFormViews:e.data.steps[1]?.count||0,contactFormSubmits:e.data.steps[2]?.count||0,appointmentFormViews:e.data.steps[3]?.count||0,appointmentFormSubmits:e.data.steps[4]?.count||0,appointmentConfirmations:e.data.steps[5]?.count||0,conversionRate:e.data.overall_conversion_rate||0}:v(),j=f.success?f.data.sources:{organic:65,social:20,direct:10,campaigns:5},k=g.success?{lcp:g.data.lcp?.value||2.1,fid:g.data.fid?.value||85,cls:g.data.cls?.value||.08,ttfb:g.data.ttfb?.value||450}:{lcp:2.1,fid:85,cls:.08,ttfb:450},l=h.success?{totalBookings:h.data.appointments?.total||0,confirmationRate:h.data.appointments?.confirmation_rate||0,noShowRate:h.data.appointments?.no_show_rate||0,completionRate:h.data.appointments?.completion_rate||0}:{totalBookings:32,confirmationRate:87.5,noShowRate:8.3,completionRate:91.7};return{funnel:i,traffic:j,webVitals:k,appointments:l}}catch(a){return console.error("Error fetching analytics data:",a),w()}},v=()=>({pageViews:1250,contactFormViews:180,contactFormSubmits:45,appointmentFormViews:85,appointmentFormSubmits:32,appointmentConfirmations:28,conversionRate:2.24}),w=()=>({funnel:v(),traffic:{organic:65,social:20,direct:10,campaigns:5},webVitals:{lcp:2.1,fid:85,cls:.08,ttfb:450},appointments:{totalBookings:32,confirmationRate:87.5,noShowRate:8.3,completionRate:91.7}});return i?(0,l.jsx)("div",{className:"analytics-dashboard loading",children:(0,l.jsxs)("div",{className:"loading-spinner",children:[(0,l.jsx)("div",{className:"spinner"}),(0,l.jsx)("p",{children:"Carregando dados de analytics..."})]})}):k?(0,l.jsx)("div",{className:"analytics-dashboard error",children:(0,l.jsxs)("div",{className:"error-message",children:[(0,l.jsx)("h3",{children:"Erro ao carregar analytics"}),(0,l.jsx)("p",{children:k}),(0,l.jsx)("button",{onClick:t,className:"retry-button",children:"Tentar novamente"})]})}):(0,l.jsxs)("div",{className:"analytics-dashboard",children:[(0,l.jsxs)("div",{className:"dashboard-header",children:[(0,l.jsx)("h2",{children:"Analytics Dashboard"}),(0,l.jsx)("button",{onClick:t,className:"refresh-button",children:"Atualizar dados"})]}),(0,l.jsxs)("div",{className:"dashboard-grid",children:[(0,l.jsxs)("div",{className:"dashboard-card funnel-card",children:[(0,l.jsx)("h3",{children:"Funil de Convers\xe3o"}),a&&(0,l.jsx)(o,{data:a})]}),(0,l.jsxs)("div",{className:"dashboard-card traffic-card",children:[(0,l.jsx)("h3",{children:"Fontes de Tr\xe1fego"}),c&&(0,l.jsx)(p,{data:c})]}),(0,l.jsxs)("div",{className:"dashboard-card vitals-card",children:[(0,l.jsx)("h3",{children:"Core Web Vitals"}),e&&(0,l.jsx)(q,{data:e})]}),(0,l.jsxs)("div",{className:"dashboard-card appointments-card",children:[(0,l.jsx)("h3",{children:"M\xe9tricas de Agendamentos"}),g&&(0,l.jsx)(r,{data:g})]})]})]})};var u=c(62441);c(73243),c(67009);let v=()=>{let{trackEvent:a,trackInteraction:b,trackFormView:c,isEnabled:d}=(0,u.st)(),e=d=>{switch(d){case"contact_form_view":c("contact");break;case"appointment_form_view":c("appointment");break;case"button_click":b("click","demo_button",{demo:!0});break;case"page_visit":a("page_visit");break;default:console.log("Unknown event type")}};return(0,l.jsx)("div",{className:"analytics-demo-page",children:(0,l.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"Analytics Integration Demo"}),(0,l.jsxs)("div",{className:"mb-8 p-4 bg-gray-100 rounded-lg",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Analytics Status"}),(0,l.jsxs)("p",{className:"mb-2",children:[(0,l.jsx)("strong",{children:"Status:"})," ",d()?"✅ Enabled":"❌ Disabled"]}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:["Analytics tracking is ",d()?"active":"inactive",".",!d()&&" Please accept cookies to enable analytics."]})]}),(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Test Analytics Events"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,l.jsx)("button",{onClick:()=>e("page_visit"),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Track Page Visit"}),(0,l.jsx)("button",{onClick:()=>e("contact_form_view"),className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"Track Contact Form View"}),(0,l.jsx)("button",{onClick:()=>e("appointment_form_view"),className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700",children:"Track Appointment Form View"}),(0,l.jsx)("button",{onClick:()=>e("button_click"),className:"px-4 py-2 bg-orange-600 text-white rounded hover:bg-orange-700",children:"Track Button Click"})]})]}),(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Analytics Dashboard"}),(0,l.jsx)(t,{})]}),(0,l.jsxs)("div",{className:"bg-blue-50 p-6 rounded-lg",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Implementation Notes"}),(0,l.jsxs)("ul",{className:"list-disc list-inside space-y-2 text-sm",children:[(0,l.jsx)("li",{children:"PostHog analytics integration with LGPD compliance"}),(0,l.jsx)("li",{children:"Conversion funnel tracking: visit → contact → appointment → confirmation"}),(0,l.jsx)("li",{children:"UTM parameter tracking for traffic source analysis"}),(0,l.jsx)("li",{children:"Core Web Vitals monitoring for performance insights"}),(0,l.jsx)("li",{children:"Appointment completion rate tracking"}),(0,l.jsx)("li",{children:"User consent management with cookie banner"}),(0,l.jsx)("li",{children:"Real-time analytics dashboard with API integration"}),(0,l.jsx)("li",{children:"Privacy-first approach - no PII in analytics events"})]})]})]})})};var w=c(12289);let x=(0,g.M)(d,"default"),y=(0,g.M)(d,"getStaticProps"),z=(0,g.M)(d,"getStaticPaths"),A=(0,g.M)(d,"getServerSideProps"),B=(0,g.M)(d,"config"),C=(0,g.M)(d,"reportWebVitals"),D=(0,g.M)(d,"unstable_getStaticProps"),E=(0,g.M)(d,"unstable_getStaticPaths"),F=(0,g.M)(d,"unstable_getStaticParams"),G=(0,g.M)(d,"unstable_getServerProps"),H=(0,g.M)(d,"unstable_getServerSideProps"),I=new e.PagesRouteModule({definition:{kind:f.RouteKind.PAGES,page:"/AnalyticsDemo",pathname:"/AnalyticsDemo",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:k(),Document:i()},userland:d}),J=(0,w.U)({srcPage:"/AnalyticsDemo",config:B,userland:d,routeModule:I,getStaticPaths:z,getStaticProps:y,getServerSideProps:A})},73243:()=>{},74120:a=>{"use strict";a.exports=require("posthog-js")},82015:a=>{"use strict";a.exports=require("react")}};var b=require("../webpack-runtime.js");b.C(a);var c=b.X(0,[5611,157],()=>b(b.s=72113));module.exports=c})();