# Security Headers - SaraivaVision Optimized
# Medical clinic website security headers
# Updated: September 2025

# HSTS with preload (A+ security rating)
add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload" always;

# Referrer policy for privacy
add_header Referrer-Policy "strict-origin-when-cross-origin" always;

# MIME type sniffing prevention
add_header X-Content-Type-Options "nosniff" always;

# Clickjacking protection
add_header X-Frame-Options "SAMEORIGIN" always;

# XSS protection (legacy support)
add_header X-XSS-Protection "1; mode=block" always;

# Permissions policy (updated for medical site)
add_header Permissions-Policy "
    geolocation=(self),
    microphone=(),
    camera=(),
    payment=(),
    usb=(),
    interest-cohort=(),
    unload=(self),
    fullscreen=(self),
    picture-in-picture=(self)
" always;

# Cache control base
add_header Cache-Control "no-transform" always;

# Additional security for medical compliance
add_header X-Permitted-Cross-Domain-Policies "none" always;
add_header Cross-Origin-Embedder-Policy "unsafe-none" always;
add_header Cross-Origin-Opener-Policy "same-origin-allow-popups" always;
add_header Cross-Origin-Resource-Policy "cross-origin" always;