###############################################################################
# MONITORAMENTO DO RSYSLOG
# Sistema de logging centralizado
# Crítico para auditoria e troubleshooting
###############################################################################

check process rsyslog matching "rsyslogd"
    group system
    start program = "/usr/bin/systemctl start rsyslog"
    stop program = "/usr/bin/systemctl stop rsyslog"
    
    # Verificar se processo está rodando
    if not exist for 2 cycles then restart
    
    # Monitorar uso de CPU
    if cpu > 60% for 5 cycles then alert
    
    # Monitorar uso de memória
    if totalmem > 150 MB for 5 cycles then alert
    
    # Limitar tentativas de restart
    if 3 restarts within 5 cycles then timeout

