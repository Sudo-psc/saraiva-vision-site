(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9647],{3553:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>k});var t,a=s(95155),n=s(12115),o=s(20063),i="clover",c="https://js.stripe.com",l="".concat(c,"/").concat(i,"/stripe.js"),d=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,m=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/,u=function(){for(var e=document.querySelectorAll('script[src^="'.concat(c,'"]')),r=0;r<e.length;r++){var s,t=e[r];if(s=t.src,d.test(s)||m.test(s))return t}return null},p=function(e){var r=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",s=document.createElement("script");s.src="".concat(l).concat(r);var t=document.head||document.body;if(!t)throw Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return t.appendChild(s),s},h=function(e,r){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"8.0.0",startTime:r})},x=null,b=null,f=null,g=function(e,r,s){if(null===e)return null;var t,a=r[0].match(/^pk_test/),n=3===(t=e.version)?"v3":t;a&&n!==i&&console.warn("Stripe.js@".concat(n," was loaded on the page, but @stripe/stripe-js@").concat("8.0.0"," expected Stripe.js@").concat(i,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var o=e.apply(void 0,r);return h(o,s),o},v=!1,j=function(){return t?t:t=(null!==x?x:(x=new Promise(function(e,r){if("undefined"==typeof window||"undefined"==typeof document)return void e(null);if(window.Stripe,window.Stripe)return void e(window.Stripe);try{var s,t=u();t?t&&null!==f&&null!==b&&(t.removeEventListener("load",f),t.removeEventListener("error",b),null==(s=t.parentNode)||s.removeChild(t),t=p(null)):t=p(null),f=function(){window.Stripe?e(window.Stripe):r(Error("Stripe.js not available"))},b=function(e){r(Error("Failed to load Stripe.js",{cause:e}))},t.addEventListener("load",f),t.addEventListener("error",b)}catch(e){r(e);return}})).catch(function(e){return x=null,Promise.reject(e)})).catch(function(e){return t=null,Promise.reject(e)})};Promise.resolve().then(function(){return j()}).catch(function(e){v||console.warn(e)});let y={basic:{id:"basic",name:"Basic",description:"1 par de lentes por m\xeas",price:4900,priceFormatted:"R$ 49",features:["1 par de lentes de contato por m\xeas","Lentes de prescri\xe7\xe3o b\xe1sica","Suporte online","Cancelamento a qualquer momento"]},pro:{id:"pro",name:"Pro",description:"2 pares + experimenta\xe7\xe3o virtual",price:7900,priceFormatted:"R$ 79",recommended:!0,features:["2 pares de lentes por m\xeas (principal + reserva)","Lentes premium","Experimenta\xe7\xe3o virtual","Suporte priorit\xe1rio","Descontos em arma\xe7\xf5es"]},premium:{id:"premium",name:"Premium",description:"Lentes ilimitadas + consultas",price:9900,priceFormatted:"R$ 99",features:["Substitui\xe7\xf5es ilimitadas de lentes","Arma\xe7\xf5es de grife inclu\xeddas","Consultas presenciais","Acesso a recursos exclusivos do app","Concierge oftalmol\xf3gico"]}},N=function(){for(var e=arguments.length,r=Array(e),s=0;s<e;s++)r[s]=arguments[s];v=!0;var t=Date.now();return j().then(function(e){return g(e,r,t)})}(s(95704).env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY||"");function w(e){let{planId:r,onSuccess:s,onCancel:t}=e,[o,i]=(0,n.useState)(!1),[c,l]=(0,n.useState)(null),[d,m]=(0,n.useState)(!1),[u,p]=(0,n.useState)({name:"",email:"",consentTerms:!1,consentPrivacy:!1,consentMarketing:!1,medicalDisclaimer:!1}),h=async e=>{e.preventDefault(),l(null),i(!0);try{if(!u.name||!u.email)throw Error("Nome e email s\xe3o obrigat\xf3rios");if(!u.consentTerms||!u.consentPrivacy)throw Error("Voc\xea deve aceitar os termos e a pol\xedtica de privacidade");if(!u.medicalDisclaimer)throw Error("Voc\xea deve ler e aceitar o aviso m\xe9dico");let e="pm_"+Math.random().toString(36).substring(7),t=await fetch("/api/subscription/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({planId:r,email:u.email,name:u.name,paymentMethodId:e,consentTerms:u.consentTerms,consentPrivacy:u.consentPrivacy,consentMarketing:u.consentMarketing})}),a=await t.json();if(!a.success)throw Error(a.error||"Erro ao criar assinatura");if(a.subscription.clientSecret&&!await N)throw Error("Stripe n\xe3o carregado");s(a.subscription.id)}catch(e){l(e instanceof Error?e.message:"Erro desconhecido")}finally{i(!1)}};return(0,a.jsx)("div",{className:"mx-auto max-w-2xl",children:(0,a.jsxs)("form",{onSubmit:h,className:"space-y-6 rounded-lg bg-white p-8 shadow-lg",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Finalizar Assinatura"}),c&&(0,a.jsx)("div",{className:"rounded-lg bg-red-50 p-4 text-sm text-red-800",children:c}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Nome Completo *"}),(0,a.jsx)("input",{type:"text",id:"name",value:u.name,onChange:e=>p({...u,name:e.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email *"}),(0,a.jsx)("input",{type:"email",id:"email",value:u.email,onChange:e=>p({...u,email:e.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500",required:!0})]})]}),(0,a.jsxs)("div",{className:"rounded-lg border border-gray-200 p-4",children:[(0,a.jsx)("p",{className:"mb-2 text-sm font-medium text-gray-700",children:"M\xe9todo de Pagamento"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"O formul\xe1rio de cart\xe3o do Stripe ser\xe1 exibido aqui em produ\xe7\xe3o"})]}),(0,a.jsxs)("div",{className:"space-y-3 rounded-lg border border-yellow-200 bg-yellow-50 p-4",children:[(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("input",{type:"checkbox",id:"medicalDisclaimer",checked:u.medicalDisclaimer,onChange:e=>p({...u,medicalDisclaimer:e.target.checked}),className:"mt-1 h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,a.jsxs)("label",{htmlFor:"medicalDisclaimer",className:"ml-3 text-sm text-gray-700",children:["Li e compreendi o"," ",(0,a.jsx)("button",{type:"button",onClick:()=>m(!d),className:"font-semibold text-blue-600 hover:underline",children:"aviso m\xe9dico importante"})]})]}),d&&(0,a.jsx)("div",{className:"mt-3 max-h-48 overflow-y-auto rounded border border-yellow-300 bg-white p-3 text-xs text-gray-700",children:(0,a.jsx)("pre",{className:"whitespace-pre-wrap font-sans",children:"\nAVISO M\xc9DICO IMPORTANTE:\n\nEste servi\xe7o de assinatura de lentes \xe9 complementar ao acompanhamento oftalmol\xf3gico regular.\nA assinatura N\xc3O substitui consultas m\xe9dicas peri\xf3dicas com oftalmologista.\n\nRecomendamos consultas oftalmol\xf3gicas pelo menos uma vez ao ano, ou conforme orienta\xe7\xe3o m\xe9dica.\n\nEm caso de desconforto, vermelhid\xe3o, dor ou altera\xe7\xf5es visuais, suspenda o uso das lentes\ne consulte imediatamente um oftalmologista.\n\nAs lentes fornecidas s\xe3o baseadas na sua prescri\xe7\xe3o mais recente. \xc9 sua responsabilidade\nmanter sua prescri\xe7\xe3o atualizada atrav\xe9s de consultas regulares.\n\nAo prosseguir, voc\xea reconhece ter lido e compreendido este aviso m\xe9dico.\n"})})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("input",{type:"checkbox",id:"consentTerms",checked:u.consentTerms,onChange:e=>p({...u,consentTerms:e.target.checked}),className:"mt-1 h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500",required:!0}),(0,a.jsxs)("label",{htmlFor:"consentTerms",className:"ml-3 text-sm text-gray-700",children:["Aceito os"," ",(0,a.jsx)("a",{href:"/termos",className:"text-blue-600 hover:underline",target:"_blank",children:"Termos de Servi\xe7o"})," ","*"]})]}),(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("input",{type:"checkbox",id:"consentPrivacy",checked:u.consentPrivacy,onChange:e=>p({...u,consentPrivacy:e.target.checked}),className:"mt-1 h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500",required:!0}),(0,a.jsxs)("label",{htmlFor:"consentPrivacy",className:"ml-3 text-sm text-gray-700",children:["Aceito a"," ",(0,a.jsx)("a",{href:"/privacidade",className:"text-blue-600 hover:underline",target:"_blank",children:"Pol\xedtica de Privacidade"})," ","(LGPD) *"]})]}),(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("input",{type:"checkbox",id:"consentMarketing",checked:u.consentMarketing,onChange:e=>p({...u,consentMarketing:e.target.checked}),className:"mt-1 h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,a.jsx)("label",{htmlFor:"consentMarketing",className:"ml-3 text-sm text-gray-700",children:"Desejo receber ofertas e novidades por email"})]})]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("button",{type:"button",onClick:t,className:"flex-1 rounded-lg border border-gray-300 bg-white px-6 py-3 font-semibold text-gray-700 hover:bg-gray-50",disabled:o,children:"Cancelar"}),(0,a.jsx)("button",{type:"submit",className:"flex-1 rounded-lg bg-blue-600 px-6 py-3 font-semibold text-white hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-50",disabled:o,children:o?"Processando...":"Assinar Agora"})]})]})})}function S(){let e=(0,o.useRouter)(),r=(0,o.useSearchParams)(),[s,t]=(0,n.useState)(null);if((0,n.useEffect)(()=>{let s=r.get("plan");s&&y[s]?t(s):e.push("/jovem/assinatura")},[r,e]),!s)return(0,a.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,a.jsx)("div",{className:"text-xl text-gray-600",children:"Carregando..."})});let i=y[s];return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 py-16 px-4",children:(0,a.jsxs)("div",{className:"mx-auto max-w-4xl",children:[(0,a.jsxs)("div",{className:"mb-8 text-center",children:[(0,a.jsx)("h1",{className:"mb-2 text-3xl font-bold text-gray-900",children:"Checkout"}),(0,a.jsxs)("p",{className:"text-gray-600",children:["Plano: ",(0,a.jsx)("span",{className:"font-semibold",children:i.name})," -"," ",i.priceFormatted,"/m\xeas"]})]}),(0,a.jsx)(w,{planId:s,onSuccess:r=>{e.push("/jovem/assinatura/success?subscription=".concat(r))},onCancel:()=>{e.push("/jovem/assinatura")}}),(0,a.jsx)("div",{className:"mt-8 text-center text-sm text-gray-600",children:(0,a.jsx)("p",{children:"Pagamento seguro processado via Stripe. Seus dados s\xe3o protegidos com criptografia SSL."})})]})})}function k(){return(0,a.jsx)(n.Suspense,{fallback:(0,a.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,a.jsx)("div",{className:"text-xl text-gray-600",children:"Carregando..."})}),children:(0,a.jsx)(S,{})})}},20063:(e,r,s)=>{"use strict";var t=s(47260);s.o(t,"usePathname")&&s.d(r,{usePathname:function(){return t.usePathname}}),s.o(t,"useRouter")&&s.d(r,{useRouter:function(){return t.useRouter}}),s.o(t,"useSearchParams")&&s.d(r,{useSearchParams:function(){return t.useSearchParams}})},78715:(e,r,s)=>{Promise.resolve().then(s.bind(s,3553))}},e=>{e.O(0,[8441,1255,7358],()=>e(e.s=78715)),_N_E=e.O()}]);