# Redis Configuration for SaraivaVision Medical Website
# Dr. Philipe Saraiva Cruz - CRM-MG 69.870
# Optimized for WordPress Object Cache with Medical Website Requirements

# Basic server configuration
bind 127.0.0.1
port 6379
timeout 300
tcp-keepalive 60

# Memory management for medical website caching
maxmemory 256mb
maxmemory-policy allkeys-lru

# Persistence settings for medical website data integrity
save 900 1      # Save after 900 seconds if at least 1 key changed
save 300 10     # Save after 300 seconds if at least 10 keys changed
save 60 10000   # Save after 60 seconds if at least 10000 keys changed

# Database file settings
dbfilename saraivavision-redis.rdb
dir /data

# Logging for medical website compliance
loglevel notice
logfile /var/log/redis/saraivavision-redis.log

# Security settings for medical data protection
# requirepass your_secure_redis_password_here
# rename-command FLUSHDB ""
# rename-command FLUSHALL ""
# rename-command CONFIG ""

# Network and connection settings
tcp-backlog 511
databases 16

# Memory optimization
hash-max-ziplist-entries 512
hash-max-ziplist-value 64
list-max-ziplist-size -2
list-compress-depth 0
set-max-intset-entries 512
zset-max-ziplist-entries 128
zset-max-ziplist-value 64

# Client connection limits
maxclients 10000

# Slow log for performance monitoring
slowlog-log-slower-than 10000
slowlog-max-len 128

# Advanced configuration for medical website performance
hz 10
dynamic-hz yes

# AOF (Append Only File) for better durability of medical data cache
appendonly yes
appendfilename "saraivavision-appendonly.aof"
appendfsync everysec
no-appendfsync-on-rewrite no
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb

# Disable potentially dangerous commands for medical website security
rename-command DEBUG ""
rename-command SHUTDOWN SHUTDOWN_SARAIVA_MEDICAL

# Client output buffer limits
client-output-buffer-limit normal 0 0 0
client-output-buffer-limit replica 256mb 64mb 60
client-output-buffer-limit pubsub 32mb 8mb 60

# Medical website specific settings
# These settings optimize Redis for WordPress object caching patterns
# Common in medical websites with mixed content types

# Optimize for WordPress transients and options
set-max-intset-entries 512

# Optimize for post content caching
hash-max-ziplist-entries 512
hash-max-ziplist-value 64

# Enable keyspace notifications for cache monitoring
notify-keyspace-events Ex

# SSL/TLS configuration (uncomment for production)
# tls-port 6380
# tls-cert-file /etc/ssl/certs/redis.crt
# tls-key-file /etc/ssl/private/redis.key
# tls-ca-cert-file /etc/ssl/certs/ca.crt