###############################################################################
# MONITORAMENTO DE RECURSOS DO SISTEMA
# Servidor: srv846611 (Saraiva Vision VPS)
# Objetivo: Monitorar disco, memória, swap, CPU e load average
###############################################################################

# ============================================================================
# PARTIÇÃO RAIZ (/) - 96GB total, 61% usado atualmente
# ============================================================================
check filesystem rootfs with path /
    if space usage > 85% for 3 cycles then alert
    if space usage > 95% then alert
    if inode usage > 90% then alert
    if read rate > 30 MB/s for 3 cycles then alert
    if write rate > 20 MB/s for 3 cycles then alert
    group system

# ============================================================================
# PARTIÇÃO /boot - Kernel e initrd
# ============================================================================
check filesystem boot with path /dev/sda16
    if space usage > 80% then alert
    if inode usage > 85% then alert
    group system

# ============================================================================
# PARTIÇÃO /boot/efi - EFI System Partition
# ============================================================================
check filesystem bootefi with path /dev/sda15
    if space usage > 70% then alert
    group system

# ============================================================================
# MEMÓRIA RAM - 7.8GB total (26% em uso atualmente = saudável)
# ============================================================================
check system $HOST
    if loadavg (1min) > 4 for 3 cycles then alert      # 2 cores * 2 = limite crítico
    if loadavg (5min) > 3 for 5 cycles then alert
    if loadavg (15min) > 2 for 10 cycles then alert
    if cpu usage > 95% for 5 cycles then alert
    if memory usage > 90% for 3 cycles then alert      # RAM > 90% = problema
    if memory usage > 95% then alert                   # RAM > 95% = crítico
    if swap usage > 50% for 5 cycles then alert        # Swap > 50% indica falta de RAM
    if swap usage > 75% then alert                     # Swap > 75% = crítico
    group system

